<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>dubboSPIè¯¦è§£ | å¿ƒæ— è¿·æƒ˜</title>
  <meta name="keywords" content=" SPI ">
  <meta name="description" content="dubboSPIè¯¦è§£ | å¿ƒæ— è¿·æƒ˜">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="11æœˆçš„æœ€åä¸€å¤©ï¼Œå³æ—¶ç»“æŸåˆæ˜¯å¼€å§‹ã€‚å¸Œæœ›æˆ‘ä»¬éƒ½èƒ½å¤ŸåŠªåŠ›å­¦ä¹ ï¼ŒåšæŒä¸æ‡ˆçš„å»è¿½é€è‡ªå·±çš„æ¢¦æƒ³ã€‚å¤ä¹‹ç«‹å¤§äº‹è€…ï¼Œä¸æƒŸæœ‰è¶…ä¸–ä¹‹æ‰ï¼Œäº¦å¿…æœ‰åšå¿ä¸æ‹”ä¹‹å¿— å¿ƒå­˜è¿·æƒ˜ åˆ™æ— æ³•ç»§ç»­å‰è¡ŒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ’ªğŸ’ªğŸ’ªğŸ’ªğŸ’ªğŸ’ª">
<meta property="og:type" content="website">
<meta property="og:title" content="å…³äº">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;about&#x2F;index.html">
<meta property="og:site_name" content="å¿ƒæ— è¿·æƒ˜">
<meta property="og:description" content="11æœˆçš„æœ€åä¸€å¤©ï¼Œå³æ—¶ç»“æŸåˆæ˜¯å¼€å§‹ã€‚å¸Œæœ›æˆ‘ä»¬éƒ½èƒ½å¤ŸåŠªåŠ›å­¦ä¹ ï¼ŒåšæŒä¸æ‡ˆçš„å»è¿½é€è‡ªå·±çš„æ¢¦æƒ³ã€‚å¤ä¹‹ç«‹å¤§äº‹è€…ï¼Œä¸æƒŸæœ‰è¶…ä¸–ä¹‹æ‰ï¼Œäº¦å¿…æœ‰åšå¿ä¸æ‹”ä¹‹å¿— å¿ƒå­˜è¿·æƒ˜ åˆ™æ— æ³•ç»§ç»­å‰è¡ŒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ˜ƒğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ§ğŸ’ªğŸ’ªğŸ’ªğŸ’ªğŸ’ªğŸ’ª">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2020-02-15T13:29:23.087Z">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.0.1" rel="stylesheet">

<link href="/css/hl_theme/atom-light.css?v=1.0.1" rel="stylesheet">

<link href="//cdn.bootcss.com/animate.css/3.5.2/animate.min.css" rel="stylesheet">
<link href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="/js/jquery.autocomplete.min.js?v=1.0.1" ></script>

<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.bootcss.com/nprogress/0.2.0/nprogress.min.js"></script>



<script src="//cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.0.1" ></script>

</head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="false">
  <input class="theme_blog_path" value="">
</div>

<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>Ocean Bai</span>
</div>

<div class="icon">
    
        
    
        
        <a title="github" href="https://github.com/oceanbai" target="_blank">
            
                <svg class="iconfont-svg" aria-hidden="true">
                    <use xlink:href="#icon-github"></use>
                </svg>
            
        </a>
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
</div>




<ul>
    <li><div class="all active">å…¨éƒ¨æ–‡ç« <small>(30)</small></div></li>
    
        
            
            <li><div data-rel="dubbo">dubbo<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="javaåŸºç¡€">javaåŸºç¡€<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="ç®—æ³•">ç®—æ³•<small>(4)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="è®¾è®¡æ¨¡å¼">è®¾è®¡æ¨¡å¼<small>(6)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="é¢è¯•">é¢è¯•<small>(4)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="è®¾è®¡åŸåˆ™">è®¾è®¡åŸåˆ™<small>(7)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="JDK">JDK<small>(2)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div><a class="about  hasFriend  site_url"  href="/about">å…³äº</a><a style="width: 50%"  class="friends">å‹é“¾</a></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="30">
<input type="hidden" id="yelog_site_word_count" value="110.7k">
<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        å‹æƒ…é“¾æ¥
        <i class="back-title-list"></i>
    </div>
    <div class="friends-content">
        <ul>
            
            <li><a target="_blank" href="https://yelog.org/">å¶è½é˜</a></li>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <form onkeydown="if(event.keyCode==13){return false;}">
        <input class="search" type="text" placeholder="Search..." autocomplete="off"id="local-search-input" >
        <i class="cross"></i>
        <span>
            <label for="tagswitch">Tags:</label>
            <input id="tagswitch" type="checkbox" style="display: none" />
            <i id="tagsWitchIcon"></i>
        </span>
    </form>
    <div class="tags-list">
    
    <li class="article-tag-list-item">
        <a class="color5">åŠ¨æ€ä»£ç†</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">SPI</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">é¢è¯•</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">åƒåœ¾</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">ç±»åŠ è½½å™¨</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">ç¼“å­˜</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">ç®—æ³•</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color3">åå°„</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">è®¾è®¡æ¨¡å¼</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">å·¥å‚æ¨¡å¼</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">æ€»ç»“é¢è¯•</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color5">è®¾è®¡åŸåˆ™</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">jdk</a>
    </li>
    
    <li class="article-tag-list-item">
        <a class="color4">çº¿ç¨‹æ± </a>
    </li>
    
    <div class="clearfix"></div>
</div>

    
    <nav id="title-list-nav">
        
        <a  class="JDK "
           href="/2020/02/19/java/JDK/ThreadLocal%E6%BA%90%E7%A0%81%E8%A7%A3%E6%9E%90/"
           data-tag="jdk"
           data-author="" >
            <span class="post-title" title="ThreadLocalæºç è§£æ">ThreadLocalæºç è§£æ</span>
            <span class="post-date" title="2020-02-19 09:41:31">2020/02/19</span>
        </a>
        
        <a  class="é¢è¯• "
           href="/2020/02/18/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E6%8A%80%E6%9C%AF%E6%A0%88/"
           data-tag="é¢è¯•,æ€»ç»“é¢è¯•"
           data-author="" >
            <span class="post-title" title="é¢è¯•æŠ€æœ¯æ ˆ">é¢è¯•æŠ€æœ¯æ ˆ</span>
            <span class="post-date" title="2020-02-18 16:41:32">2020/02/18</span>
        </a>
        
        <a  class="dubbo "
           href="/2020/02/17/dubbo/dubboSPI/"
           data-tag="SPI"
           data-author="" >
            <span class="post-title" title="dubboSPIè¯¦è§£">dubboSPIè¯¦è§£</span>
            <span class="post-date" title="2020-02-17 14:41:31">2020/02/17</span>
        </a>
        
        <a  class="é¢è¯• "
           href="/2020/02/17/%E9%9D%A2%E8%AF%95/%E7%BE%8E%E5%9B%A2%E7%A0%94%E7%A9%B6%E7%94%9F%E5%AE%9E%E4%B9%A0%E7%94%9F/"
           data-tag="é¢è¯•"
           data-author="" >
            <span class="post-title" title="ç¾å›¢ç ”ç©¶ç”Ÿå®ä¹ ç”Ÿ">ç¾å›¢ç ”ç©¶ç”Ÿå®ä¹ ç”Ÿ</span>
            <span class="post-date" title="2020-02-17 11:41:31">2020/02/17</span>
        </a>
        
        <a  class=""
           href="/2020/02/17/%E7%AE%97%E6%B3%95/%E5%9F%BA%E6%9C%AC%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="ç®—æ³•/åŸºæœ¬æ’åºç®—æ³•">ç®—æ³•/åŸºæœ¬æ’åºç®—æ³•</span>
            <span class="post-date" title="2020-02-17 10:46:52">2020/02/17</span>
        </a>
        
        <a  class="è®¾è®¡æ¨¡å¼ "
           href="/2020/02/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/"
           data-tag="è®¾è®¡æ¨¡å¼"
           data-author="" >
            <span class="post-title" title="æ¡¥æ¥æ¨¡å¼----å¤„ç†å¤šç»´å˜åŒ–----äº”">æ¡¥æ¥æ¨¡å¼----å¤„ç†å¤šç»´å˜åŒ–----äº”</span>
            <span class="post-date" title="2020-02-15 21:42:31">2020/02/15</span>
        </a>
        
        <a  class="è®¾è®¡æ¨¡å¼ "
           href="/2020/02/15/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/"
           data-tag="è®¾è®¡æ¨¡å¼"
           data-author="" >
            <span class="post-title" title="é€‚é…å™¨æ¨¡å¼----ä¸å…¼å®¹ç»“æ„çš„åè°ƒ----å…­">é€‚é…å™¨æ¨¡å¼----ä¸å…¼å®¹ç»“æ„çš„åè°ƒ----å…­</span>
            <span class="post-date" title="2020-02-15 21:42:31">2020/02/15</span>
        </a>
        
        <a  class="é¢è¯• "
           href="/2020/02/15/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E9%A2%98/"
           data-tag="é¢è¯•"
           data-author="" >
            <span class="post-title" title="é¢è¯•é¢˜">é¢è¯•é¢˜</span>
            <span class="post-date" title="2020-02-15 21:41:32">2020/02/15</span>
        </a>
        
        <a  class="è®¾è®¡æ¨¡å¼ "
           href="/2020/02/14/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"
           data-tag="è®¾è®¡æ¨¡å¼"
           data-author="" >
            <span class="post-title" title="æ¨¡æ¿æ–¹æ³•æ¨¡å¼--------å››">æ¨¡æ¿æ–¹æ³•æ¨¡å¼--------å››</span>
            <span class="post-date" title="2020-02-14 16:38:31">2020/02/14</span>
        </a>
        
        <a  class="è®¾è®¡æ¨¡å¼ "
           href="/2020/02/13/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"
           data-tag="è®¾è®¡æ¨¡å¼,å·¥å‚æ¨¡å¼"
           data-author="" >
            <span class="post-title" title="æŠ½è±¡å·¥å‚æ¨¡å¼--------ä¸‰">æŠ½è±¡å·¥å‚æ¨¡å¼--------ä¸‰</span>
            <span class="post-date" title="2020-02-13 21:41:31">2020/02/13</span>
        </a>
        
        <a  class="javaåŸºç¡€ "
           href="/2020/02/12/java/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8(ClassLoader)/"
           data-tag="ç±»åŠ è½½å™¨"
           data-author="" >
            <span class="post-title" title="æ·±å…¥ç†è§£javaç±»åŠ è½½å™¨(ClassLoader)">æ·±å…¥ç†è§£javaç±»åŠ è½½å™¨(ClassLoader)</span>
            <span class="post-date" title="2020-02-12 21:41:31">2020/02/12</span>
        </a>
        
        <a  class="javaåŸºç¡€ "
           href="/2020/02/12/java/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3Java%E7%B1%BB%E5%9E%8B%E4%BF%A1%E6%81%AF(Class%E5%AF%B9%E8%B1%A1)%E4%B8%8E%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6/"
           data-tag="åå°„"
           data-author="" >
            <span class="post-title" title="æ·±å…¥ç†è§£Javaç±»å‹ä¿¡æ¯(Classå¯¹è±¡)ä¸åå°„æœºåˆ¶">æ·±å…¥ç†è§£Javaç±»å‹ä¿¡æ¯(Classå¯¹è±¡)ä¸åå°„æœºåˆ¶</span>
            <span class="post-date" title="2020-02-12 21:41:31">2020/02/12</span>
        </a>
        
        <a  class="ç®—æ³• "
           href="/2020/02/12/%E7%AE%97%E6%B3%95/%E7%BC%93%E5%AD%98%E7%AE%97%E6%B3%95------FIFO%20%E3%80%81LRU%E3%80%81LFU/"
           data-tag="ç¼“å­˜"
           data-author="" >
            <span class="post-title" title="ç¼“å­˜ç®—æ³•ï¼ˆFIFOã€LRUã€LFUï¼‰">ç¼“å­˜ç®—æ³•ï¼ˆFIFOã€LRUã€LFUï¼‰</span>
            <span class="post-date" title="2020-02-12 10:22:00">2020/02/12</span>
        </a>
        
        <a  class="ç®—æ³• "
           href="/2020/02/12/%E7%AE%97%E6%B3%95/%E5%9B%9E%E6%96%87%E6%95%B0/"
           data-tag="ç®—æ³•"
           data-author="" >
            <span class="post-title" title="å›æ–‡æ•°">å›æ–‡æ•°</span>
            <span class="post-date" title="2020-02-12 10:22:00">2020/02/12</span>
        </a>
        
        <a  class="ç®—æ³• "
           href="/2020/02/12/%E7%AE%97%E6%B3%95/%E9%9D%A2%E8%AF%95%E9%A2%9803-%E6%95%B0%E7%BB%84%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E6%95%B0%E5%AD%97/"
           data-tag="ç®—æ³•"
           data-author="" >
            <span class="post-title" title="é¢è¯•é¢˜03-æ•°ç»„ä¸­é‡å¤çš„æ•°å­—">é¢è¯•é¢˜03-æ•°ç»„ä¸­é‡å¤çš„æ•°å­—</span>
            <span class="post-date" title="2020-02-12 10:22:00">2020/02/12</span>
        </a>
        
        <a  class="è®¾è®¡æ¨¡å¼ "
           href="/2020/02/12/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%96%B9%E6%B3%95%E6%A8%A1%E5%BC%8F/"
           data-tag="è®¾è®¡æ¨¡å¼,å·¥å‚æ¨¡å¼"
           data-author="" >
            <span class="post-title" title="å·¥å‚æ–¹æ³•æ¨¡å¼--------äºŒ">å·¥å‚æ–¹æ³•æ¨¡å¼--------äºŒ</span>
            <span class="post-date" title="2020-02-12 10:22:00">2020/02/12</span>
        </a>
        
        <a  class="dubbo "
           href="/2020/02/11/dubbo/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%20RPC%20%E4%B9%8B%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E7%AF%87/"
           data-tag="åŠ¨æ€ä»£ç†"
           data-author="" >
            <span class="post-title" title="æ·±å…¥ç†è§£ RPC ä¹‹åŠ¨æ€ä»£ç†ç¯‡">æ·±å…¥ç†è§£ RPC ä¹‹åŠ¨æ€ä»£ç†ç¯‡</span>
            <span class="post-date" title="2020-02-11 21:41:31">2020/02/11</span>
        </a>
        
        <a  class="dubbo "
           href="/2020/02/11/dubbo/dubbo%E9%9D%A2%E8%AF%95%E9%A2%98/"
           data-tag="é¢è¯•"
           data-author="" >
            <span class="post-title" title="dubboé¢è¯•é¢˜">dubboé¢è¯•é¢˜</span>
            <span class="post-date" title="2020-02-11 21:41:31">2020/02/11</span>
        </a>
        
        <a  class="javaåŸºç¡€ "
           href="/2020/02/11/java/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/"
           data-tag="åƒåœ¾"
           data-author="" >
            <span class="post-title" title="åƒåœ¾å›æ”¶">åƒåœ¾å›æ”¶</span>
            <span class="post-date" title="2020-02-11 21:41:31">2020/02/11</span>
        </a>
        
        <a  class="è®¾è®¡æ¨¡å¼ "
           href="/2020/02/11/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"
           data-tag="è®¾è®¡æ¨¡å¼,å·¥å‚æ¨¡å¼"
           data-author="" >
            <span class="post-title" title="ç®€å•å·¥å‚æ¨¡å¼--------ä¸€">ç®€å•å·¥å‚æ¨¡å¼--------ä¸€</span>
            <span class="post-date" title="2020-02-11 21:41:31">2020/02/11</span>
        </a>
        
        <a  class="JDK "
           href="/2020/02/11/java/JDK/%E7%BA%BF%E7%A8%8B%E6%B1%A0%E8%A7%A3%E6%9E%90/"
           data-tag="çº¿ç¨‹æ± "
           data-author="" >
            <span class="post-title" title="çº¿ç¨‹æ± æºç è§£æ">çº¿ç¨‹æ± æºç è§£æ</span>
            <span class="post-date" title="2020-02-11 21:41:31">2020/02/11</span>
        </a>
        
        <a  class="ç®—æ³• "
           href="/2019/11/30/%E7%AE%97%E6%B3%95/%E4%BA%8C%E5%8F%89%E5%A0%86/"
           data-tag="ç®—æ³•"
           data-author="" >
            <span class="post-title" title="äºŒå‰å †">äºŒå‰å †</span>
            <span class="post-date" title="2019-11-30 21:49:13">2019/11/30</span>
        </a>
        
        <a  class="é¢è¯• "
           href="/2019/11/30/%E9%9D%A2%E8%AF%95/%E9%9D%A2%E8%AF%95%E8%A6%81%E6%B1%82/"
           data-tag="é¢è¯•"
           data-author="" >
            <span class="post-title" title="åˆ«äººé¢è¯•è¦æ±‚">åˆ«äººé¢è¯•è¦æ±‚</span>
            <span class="post-date" title="2019-11-30 21:41:31">2019/11/30</span>
        </a>
        
        <a  class="è®¾è®¡åŸåˆ™ "
           href="/2019/05/26/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/%E4%BE%9D%E8%B5%96%E5%80%92%E7%BD%AE%E5%8E%9F%E5%88%99/"
           data-tag="è®¾è®¡åŸåˆ™"
           data-author="" >
            <span class="post-title" title="ç¬¬äºŒåŸåˆ™:ä¾èµ–å€’ç½®åŸåˆ™">ç¬¬äºŒåŸåˆ™:ä¾èµ–å€’ç½®åŸåˆ™</span>
            <span class="post-date" title="2019-05-26 17:07:00">2019/05/26</span>
        </a>
        
        <a  class="è®¾è®¡åŸåˆ™ "
           href="/2019/05/26/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99/"
           data-tag="è®¾è®¡åŸåˆ™"
           data-author="" >
            <span class="post-title" title="ç¬¬ä¸€åŸåˆ™:å¼€é—­åŸåˆ™">ç¬¬ä¸€åŸåˆ™:å¼€é—­åŸåˆ™</span>
            <span class="post-date" title="2019-05-26 17:07:00">2019/05/26</span>
        </a>
        
        <a  class="è®¾è®¡åŸåˆ™ "
           href="/2019/05/26/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/%E5%90%88%E6%88%90%E5%A4%8D%E7%94%A8%E5%8E%9F%E5%88%99/"
           data-tag="è®¾è®¡åŸåˆ™"
           data-author="" >
            <span class="post-title" title="ç¬¬ä¸ƒåŸåˆ™:åˆæˆå¤ç”¨åŸåˆ™">ç¬¬ä¸ƒåŸåˆ™:åˆæˆå¤ç”¨åŸåˆ™</span>
            <span class="post-date" title="2019-05-26 17:07:00">2019/05/26</span>
        </a>
        
        <a  class="è®¾è®¡åŸåˆ™ "
           href="/2019/05/26/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99/"
           data-tag="è®¾è®¡åŸåˆ™"
           data-author="" >
            <span class="post-title" title="ç¬¬äº”åŸåˆ™:è¿ªç±³ç‰¹æ³•åˆ™">ç¬¬äº”åŸåˆ™:è¿ªç±³ç‰¹æ³•åˆ™</span>
            <span class="post-date" title="2019-05-26 17:07:00">2019/05/26</span>
        </a>
        
        <a  class="è®¾è®¡åŸåˆ™ "
           href="/2019/05/26/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/"
           data-tag="è®¾è®¡åŸåˆ™"
           data-author="" >
            <span class="post-title" title="ç¬¬ä¸‰åŸåˆ™:å•ä¸€èŒè´£åŸåˆ™">ç¬¬ä¸‰åŸåˆ™:å•ä¸€èŒè´£åŸåˆ™</span>
            <span class="post-date" title="2019-05-26 17:07:00">2019/05/26</span>
        </a>
        
        <a  class="è®¾è®¡åŸåˆ™ "
           href="/2019/05/26/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99/"
           data-tag="è®¾è®¡åŸåˆ™"
           data-author="" >
            <span class="post-title" title="ç¬¬å››åŸåˆ™:æ¥å£éš”ç¦»åŸåˆ™">ç¬¬å››åŸåˆ™:æ¥å£éš”ç¦»åŸåˆ™</span>
            <span class="post-date" title="2019-05-26 17:07:00">2019/05/26</span>
        </a>
        
        <a  class="è®¾è®¡åŸåˆ™ "
           href="/2019/05/26/%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99/%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99/"
           data-tag="è®¾è®¡åŸåˆ™"
           data-author="" >
            <span class="post-title" title="ç¬¬å…­åŸåˆ™:é‡Œæ°æ›¿æ¢åŸåˆ™">ç¬¬å…­åŸåˆ™:é‡Œæ°æ›¿æ¢åŸåˆ™</span>
            <span class="post-date" title="2019-05-26 17:07:00">2019/05/26</span>
        </a>
        
    </nav>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div class="post">
    <div class="pjax">
        <article id="post-dubbo/dubboSPI" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">dubboSPIè¯¦è§£</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            
                <a  data-rel="dubbo">dubbo</a>
            
        </span>
        
        
        <span class="tag">
            
            <a class="color4">SPI</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
        åˆ›å»ºæ—¶é—´:<time class="date" title='æ›´æ–°æ—¶é—´: 2020-02-17 17:15:07'>2020-02-17 14:41</time>
        
    </div>
    <div class="article-meta">
        
        <span>å­—æ•°:7.6k</span>
        
        
        <span id="busuanzi_container_page_pv">
            é˜…è¯»:<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#æ‹“å±•æœºåˆ¶-SPI"><span class="toc-text">æ‹“å±•æœºåˆ¶ SPI</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-æ¦‚è¿°"><span class="toc-text">1. æ¦‚è¿°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-æ”¹è¿›"><span class="toc-text">2. æ”¹è¿›</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-ä»£ç ç»“æ„"><span class="toc-text">3. ä»£ç ç»“æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-ExtensionLoader"><span class="toc-text">4. ExtensionLoader</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-å±æ€§"><span class="toc-text">4.1 å±æ€§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-è·å¾—æ‹“å±•é…ç½®"><span class="toc-text">4.2 è·å¾—æ‹“å±•é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-getExtensionClasses"><span class="toc-text">4.2.1 getExtensionClasses</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-loadExtensionClasses"><span class="toc-text">4.2.2 loadExtensionClasses</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-loadFile"><span class="toc-text">4.2.3 loadFile</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-4-å…¶ä»–æ–¹æ³•"><span class="toc-text">4.2.4 å…¶ä»–æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-è·å¾—æ‹“å±•åŠ è½½å™¨"><span class="toc-text">4.3 è·å¾—æ‹“å±•åŠ è½½å™¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-1-getExtensionLoader"><span class="toc-text">4.3.1 getExtensionLoader</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-3-2-æ„é€ æ–¹æ³•"><span class="toc-text">4.3.2 æ„é€ æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-è·å¾—æŒ‡å®šæ‹“å±•å¯¹è±¡"><span class="toc-text">4.4 è·å¾—æŒ‡å®šæ‹“å±•å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-1-getExtension"><span class="toc-text">4.4.1 getExtension</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-2-createExtension"><span class="toc-text">4.4.2 createExtension</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-3-injectExtension"><span class="toc-text">4.4.3 injectExtension</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-4-4-å…¶ä»–æ–¹æ³•"><span class="toc-text">4.4.4 å…¶ä»–æ–¹æ³•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-5-è·å¾—è‡ªé€‚åº”çš„æ‹“å±•å¯¹è±¡"><span class="toc-text">4.5 è·å¾—è‡ªé€‚åº”çš„æ‹“å±•å¯¹è±¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-1-getAdaptiveExtension"><span class="toc-text">4.5.1 getAdaptiveExtension</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-2-createAdaptiveExtension"><span class="toc-text">4.5.2 createAdaptiveExtension</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-3-getAdaptiveExtensionClass"><span class="toc-text">4.5.3 getAdaptiveExtensionClass</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-5-4-createAdaptiveExtensionClassCode"><span class="toc-text">4.5.4 createAdaptiveExtensionClassCode</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-è·å¾—æ¿€æ´»çš„æ‹“å±•å¯¹è±¡æ•°ç»„"><span class="toc-text">4.6 è·å¾—æ¿€æ´»çš„æ‹“å±•å¯¹è±¡æ•°ç»„</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-6-1-getExtensionLoader"><span class="toc-text">4.6.1 getExtensionLoader</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-6-2-ActivateComparator"><span class="toc-text">4.6.2 ActivateComparator</span></a></li></ol></li></ol></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="æ‹“å±•æœºåˆ¶-SPI"><a href="#æ‹“å±•æœºåˆ¶-SPI" class="headerlink" title="æ‹“å±•æœºåˆ¶ SPI"></a>æ‹“å±•æœºåˆ¶ SPI</h1><h2 id="1-æ¦‚è¿°"><a href="#1-æ¦‚è¿°" class="headerlink" title="1. æ¦‚è¿°"></a>1. æ¦‚è¿°</h2><p>æœ¬æ–‡ä¸»è¦åˆ†äº« <strong>Dubbo çš„æ‹“å±•æœºåˆ¶ SPI</strong>ã€‚</p>
<p>æƒ³è¦ç†è§£ Dubbo ï¼Œç†è§£ Dubbo SPI æ˜¯éå¸¸å¿…é¡»çš„ã€‚åœ¨ Dubbo ä¸­ï¼Œæä¾›äº†å¤§é‡çš„<strong>æ‹“å±•ç‚¹</strong>ï¼ŒåŸºäº Dubbo SPI æœºåˆ¶åŠ è½½ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/Users/ocean/Downloads/01.png" alt="Dubbo æ‹“å±•ç‚¹"></p>
<h2 id="2-æ”¹è¿›"><a href="#2-æ”¹è¿›" class="headerlink" title="2. æ”¹è¿›"></a>2. æ”¹è¿›</h2><p>ä¸ºä½•Dubboè¦è‡ªå·±å®ç°SPI</p>
<blockquote>
<p>FROM <a href="http://dubbo.apache.org/zh-cn/docs/dev/SPI.html" target="_blank" rel="noopener">ã€ŠDubbo å¼€å‘æŒ‡å— â€”â€” æ‹“å±•ç‚¹åŠ è½½ã€‹</a></p>
<p>Dubbo çš„æ‰©å±•ç‚¹åŠ è½½ä» JDK æ ‡å‡†çš„ SPI (Service Provider Interface) æ‰©å±•ç‚¹å‘ç°æœºåˆ¶åŠ å¼ºè€Œæ¥ã€‚</p>
<p>Dubbo æ”¹è¿›äº† JDK æ ‡å‡†çš„ SPI çš„ä»¥ä¸‹é—®é¢˜ï¼š</p>
<ol>
<li>JDK æ ‡å‡†çš„ SPI ä¼šä¸€æ¬¡æ€§å®ä¾‹åŒ–æ‰©å±•ç‚¹æ‰€æœ‰å®ç°ï¼Œå¦‚æœæœ‰æ‰©å±•å®ç°åˆå§‹åŒ–å¾ˆè€—æ—¶ï¼Œä½†å¦‚æœæ²¡ç”¨ä¸Šä¹ŸåŠ è½½ï¼Œä¼šå¾ˆæµªè´¹èµ„æºã€‚</li>
<li>å¦‚æœæ‰©å±•ç‚¹åŠ è½½å¤±è´¥ï¼Œè¿æ‰©å±•ç‚¹çš„åç§°éƒ½æ‹¿ä¸åˆ°äº†ã€‚æ¯”å¦‚ï¼šJDK æ ‡å‡†çš„ ScriptEngineï¼Œé€šè¿‡ getName() è·å–è„šæœ¬ç±»å‹çš„åç§°ï¼Œä½†å¦‚æœ RubyScriptEngine å› ä¸ºæ‰€ä¾èµ–çš„ jruby.jar ä¸å­˜åœ¨ï¼Œå¯¼è‡´ RubyScriptEngine ç±»åŠ è½½å¤±è´¥ï¼Œè¿™ä¸ªå¤±è´¥åŸå› è¢«åƒæ‰äº†ï¼Œå’Œ ruby å¯¹åº”ä¸èµ·æ¥ï¼Œå½“ç”¨æˆ·æ‰§è¡Œ ruby è„šæœ¬æ—¶ï¼Œä¼šæŠ¥ä¸æ”¯æŒ rubyï¼Œè€Œä¸æ˜¯çœŸæ­£å¤±è´¥çš„åŸå› ã€‚</li>
<li>å¢åŠ äº†å¯¹æ‰©å±•ç‚¹ IoC å’Œ AOP çš„æ”¯æŒï¼Œä¸€ä¸ªæ‰©å±•ç‚¹å¯ä»¥ç›´æ¥ setter æ³¨å…¥å…¶å®ƒæ‰©å±•ç‚¹ã€‚</li>
</ol>
</blockquote>
<ul>
<li>Dubbo è‡ªå·±å®ç°äº†ä¸€å¥— SPI æœºåˆ¶ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Java æ ‡å‡†çš„ SPI ã€‚</li>
<li>ç¬¬ä¸€ç‚¹é—®é¢˜ï¼ŒDubbo æœ‰å¾ˆå¤šçš„æ‹“å±•ç‚¹ï¼Œä¾‹å¦‚ Protocolã€Filter ç­‰ç­‰ã€‚å¹¶ä¸”æ¯ä¸ªæ‹“å±•ç‚¹æœ‰å¤šç§çš„å®ç°ï¼Œä¾‹å¦‚ Protocol æœ‰ DubboProtocolã€InjvmProtocolã€RestProtocol ç­‰ç­‰ã€‚é‚£ä¹ˆä½¿ç”¨ JDK SPI æœºåˆ¶ï¼Œä¼šåˆå§‹åŒ–æ— ç”¨çš„æ‹“å±•ç‚¹åŠå…¶å®ç°ï¼Œé€ æˆä¸å¿…è¦çš„è€—æ—¶ä¸èµ„æºæµªè´¹ã€‚<ul>
<li>å¦‚æœæ— æ³•ç†è§£çš„èƒ–å‹ï¼Œè·Ÿç€ <a href="http://blog.csdn.net/top_code/article/details/51934459" target="_blank" rel="noopener">ã€ŠJava SPI(Service Provider Interface)ç®€ä»‹ã€‹</a> æ–‡ç« ï¼Œ<strong>å†™å¤šä¸ªæ‹“å±•å®ç°</strong>ï¼Œå°±å¾ˆå®¹æ˜“ç†è§£äº†ã€‚</li>
</ul>
</li>
<li>ç¬¬äºŒç‚¹é—®é¢˜ï¼Œæ‰©å±•ç‚¹åŠ è½½å¤±è´¥çš„æ—¶å€™æš´éœ²å‡ºçš„é—®é¢˜å¹¶ä¸æ˜¯çœŸæ­£å¤±è´¥çš„åŸå› ã€‚</li>
<li>ç¬¬ä¸‰ç‚¹é—®é¢˜ï¼Œä¸¥æ ¼æ¥è¯´ï¼Œè¿™ä¸ç®—é—®é¢˜ï¼Œ<strong>è€Œæ˜¯å¢åŠ äº†åŠŸèƒ½ç‰¹æ€§</strong>ï¼Œåœ¨ä¸‹æ–‡æˆ‘ä»¬ä¼šçœ‹åˆ°ã€‚</li>
</ul>
<h2 id="3-ä»£ç ç»“æ„"><a href="#3-ä»£ç ç»“æ„" class="headerlink" title="3. ä»£ç ç»“æ„"></a>3. ä»£ç ç»“æ„</h2><p>Dubbo SPI åœ¨ <code>dubbo-common</code> çš„ <a href="https://github.com/YunaiV/dubbo/tree/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension" target="_blank" rel="noopener"><code>extension</code></a> åŒ…å®ç°ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<p><img src="/Users/ocean/Downloads/02.png" alt="ä»£ç ç»“æ„"></p>
<h2 id="4-ExtensionLoader"><a href="#4-ExtensionLoader" class="headerlink" title="4. ExtensionLoader"></a>4. ExtensionLoader</h2><p><a href="http://svip.iocoder.cn/Dubbo/spi/ExtensionLoader" target="_blank" rel="noopener"><code>com.alibaba.dubbo.common.extension.ExtensionLoader</code></a> ï¼Œæ‹“å±•åŠ è½½å™¨ã€‚è¿™æ˜¯ Dubbo SPI çš„<strong>æ ¸å¿ƒ</strong>ã€‚</p>
<h3 id="4-1-å±æ€§"><a href="#4-1-å±æ€§" class="headerlink" title="4.1 å±æ€§"></a>4.1 å±æ€§</h3><pre><code class="java">1: private static final String SERVICES_DIRECTORY = &quot;META-INF/services/&quot;;
  2: 
  3: private static final String DUBBO_DIRECTORY = &quot;META-INF/dubbo/&quot;;
  4: 
  5: private static final String DUBBO_INTERNAL_DIRECTORY = DUBBO_DIRECTORY + &quot;internal/&quot;;
  6: 
  7: private static final Pattern NAME_SEPARATOR = Pattern.compile(&quot;\\s*[,]+\\s*&quot;);
  8: 
  9: // ============================== é™æ€å±æ€§ ==============================
 10: 
 11: /**
 12:  * æ‹“å±•åŠ è½½å™¨é›†åˆ
 13:  *
 14:  * keyï¼šæ‹“å±•æ¥å£
 15:  */
 16: private static final ConcurrentMap&lt;Class&lt;?&gt;, ExtensionLoader&lt;?&gt;&gt; EXTENSION_LOADERS = new ConcurrentHashMap&lt;Class&lt;?&gt;, ExtensionLoader&lt;?&gt;&gt;();
 17: /**
 18:  * æ‹“å±•å®ç°ç±»é›†åˆ
 19:  *
 20:  * keyï¼šæ‹“å±•å®ç°ç±»
 21:  * valueï¼šæ‹“å±•å¯¹è±¡ã€‚
 22:  *
 23:  * ä¾‹å¦‚ï¼Œkey ä¸º Class&lt;AccessLogFilter&gt;
 24:  *  value ä¸º AccessLogFilter å¯¹è±¡
 25:  */
 26: private static final ConcurrentMap&lt;Class&lt;?&gt;, Object&gt; EXTENSION_INSTANCES = new ConcurrentHashMap&lt;Class&lt;?&gt;, Object&gt;();
 27: 
 28: // ============================== å¯¹è±¡å±æ€§ ==============================
 29: 
 30: /**
 31:  * æ‹“å±•æ¥å£ã€‚
 32:  * ä¾‹å¦‚ï¼ŒProtocol
 33:  */
 34: private final Class&lt;?&gt; type;
 35: /**
 36:  * å¯¹è±¡å·¥å‚
 37:  *
 38:  * ç”¨äºè°ƒç”¨ {@link #injectExtension(Object)} æ–¹æ³•ï¼Œå‘æ‹“å±•å¯¹è±¡æ³¨å…¥ä¾èµ–å±æ€§ã€‚
 39:  *
 40:  * ä¾‹å¦‚ï¼ŒStubProxyFactoryWrapper ä¸­æœ‰ `Protocol protocol` å±æ€§ã€‚
 41:  */
 42: private final ExtensionFactory objectFactory;
 43: /**
 44:  * ç¼“å­˜çš„æ‹“å±•åä¸æ‹“å±•ç±»çš„æ˜ å°„ã€‚
 45:  *
 46:  * å’Œ {@link #cachedClasses} çš„ KV å¯¹è°ƒã€‚
 47:  *
 48:  * é€šè¿‡ {@link #loadExtensionClasses} åŠ è½½
 49:  */
 50: private final ConcurrentMap&lt;Class&lt;?&gt;, String&gt; cachedNames = new ConcurrentHashMap&lt;Class&lt;?&gt;, String&gt;();
 51: /**
 52:  * ç¼“å­˜çš„æ‹“å±•å®ç°ç±»é›†åˆã€‚
 53:  *
 54:  * ä¸åŒ…å«å¦‚ä¸‹ä¸¤ç§ç±»å‹ï¼š
 55:  *  1. è‡ªé€‚åº”æ‹“å±•å®ç°ç±»ã€‚ä¾‹å¦‚ AdaptiveExtensionFactory
 56:  *  2. å¸¦å”¯ä¸€å‚æ•°ä¸ºæ‹“å±•æ¥å£çš„æ„é€ æ–¹æ³•çš„å®ç°ç±»ï¼Œæˆ–è€…è¯´æ‹“å±• Wrapper å®ç°ç±»ã€‚ä¾‹å¦‚ï¼ŒProtocolFilterWrapper ã€‚
 57:  *   æ‹“å±• Wrapper å®ç°ç±»ï¼Œä¼šæ·»åŠ åˆ° {@link #cachedWrapperClasses} ä¸­
 58:  *
 59:  * é€šè¿‡ {@link #loadExtensionClasses} åŠ è½½
 60:  */
 61: private final Holder&lt;Map&lt;String, Class&lt;?&gt;&gt;&gt; cachedClasses = new Holder&lt;Map&lt;String, Class&lt;?&gt;&gt;&gt;();
 62: 
 63: /**
 64:  * æ‹“å±•åä¸ @Activate çš„æ˜ å°„
 65:  *
 66:  * ä¾‹å¦‚ï¼ŒAccessLogFilterã€‚
 67:  *
 68:  * ç”¨äº {@link #getActivateExtension(URL, String)}
 69:  */
 70: private final Map&lt;String, Activate&gt; cachedActivates = new ConcurrentHashMap&lt;String, Activate&gt;();
 71: /**
 72:  * ç¼“å­˜çš„æ‹“å±•å¯¹è±¡é›†åˆ
 73:  *
 74:  * keyï¼šæ‹“å±•å
 75:  * valueï¼šæ‹“å±•å¯¹è±¡
 76:  *
 77:  * ä¾‹å¦‚ï¼ŒProtocol æ‹“å±•
 78:  *      keyï¼šdubbo valueï¼šDubboProtocol
 79:  *      keyï¼šinjvm valueï¼šInjvmProtocol
 80:  *
 81:  * é€šè¿‡ {@link #loadExtensionClasses} åŠ è½½
 82:  */
 83: private final ConcurrentMap&lt;String, Holder&lt;Object&gt;&gt; cachedInstances = new ConcurrentHashMap&lt;String, Holder&lt;Object&gt;&gt;();
 84: /**
 85:  * ç¼“å­˜çš„è‡ªé€‚åº”( Adaptive )æ‹“å±•å¯¹è±¡
 86:  */
 87: private final Holder&lt;Object&gt; cachedAdaptiveInstance = new Holder&lt;Object&gt;();
 88: /**
 89:  * ç¼“å­˜çš„è‡ªé€‚åº”æ‹“å±•å¯¹è±¡çš„ç±»
 90:  *
 91:  * {@link #getAdaptiveExtensionClass()}
 92:  */
 93: private volatile Class&lt;?&gt; cachedAdaptiveClass = null;
 94: /**
 95:  * ç¼“å­˜çš„é»˜è®¤æ‹“å±•å
 96:  *
 97:  * é€šè¿‡ {@link SPI} æ³¨è§£è·å¾—
 98:  */
 99: private String cachedDefaultName;
100: /**
101:  * åˆ›å»º {@link #cachedAdaptiveInstance} æ—¶å‘ç”Ÿçš„å¼‚å¸¸ã€‚
102:  *
103:  * å‘ç”Ÿå¼‚å¸¸åï¼Œä¸å†åˆ›å»ºï¼Œå‚è§ {@link #createAdaptiveExtension()}
104:  */
105: private volatile Throwable createAdaptiveInstanceError;
106: 
107: /**
108:  * æ‹“å±• Wrapper å®ç°ç±»é›†åˆ
109:  *
110:  * å¸¦å”¯ä¸€å‚æ•°ä¸ºæ‹“å±•æ¥å£çš„æ„é€ æ–¹æ³•çš„å®ç°ç±»
111:  *
112:  * é€šè¿‡ {@link #loadExtensionClasses} åŠ è½½
113:  */
114: private Set&lt;Class&lt;?&gt;&gt; cachedWrapperClasses;
115: 
116: /**
117:  * æ‹“å±•å ä¸ åŠ è½½å¯¹åº”æ‹“å±•ç±»å‘ç”Ÿçš„å¼‚å¸¸ çš„ æ˜ å°„
118:  *
119:  * keyï¼šæ‹“å±•å
120:  * valueï¼šå¼‚å¸¸
121:  *
122:  * åœ¨ {@link #loadFile(Map, String)} æ—¶ï¼Œè®°å½•
123:  */
124: private Map&lt;String, IllegalStateException&gt; exceptions = new ConcurrentHashMap&lt;String, IllegalStateException&gt;();</code></pre>
<ul>
<li><p>ç¬¬ 1 è‡³ 5 è¡Œï¼šåœ¨ <code>META-INF/dubbo/internal/</code> å’Œ <code>META-INF/dubbo/</code> ç›®å½•ä¸‹ï¼Œæ”¾ç½® <strong>æ¥å£å…¨é™å®šå</strong> é…ç½®æ–‡ä»¶ï¼Œ<strong>æ¯è¡Œ</strong>å†…å®¹ä¸ºï¼š<strong>æ‹“å±•å=æ‹“å±•å®ç°ç±»å…¨é™å®šå</strong>ã€‚</p>
<ul>
<li><p><code>META-INF/dubbo/internal/</code> ç›®å½•ä¸‹ï¼Œä»åå­—ä¸Šå¯ä»¥çœ‹å‡ºï¼Œç”¨äº Dubbo <strong>å†…éƒ¨</strong>æä¾›çš„æ‹“å±•å®ç°ã€‚ä¸‹å›¾æ˜¯ä¸€ä¸ªä¾‹å­ï¼š<img src="/Users/ocean/Downloads/03.png" alt="META-INF/dubbo/internal/ ä¾‹å­"></p>
</li>
<li><p><code>META-INF/dubbo/</code> ç›®å½•ä¸‹ï¼Œç”¨äºç”¨æˆ·<strong>è‡ªå®šä¹‰</strong>çš„æ‹“å±•å®ç°ã€‚</p>
</li>
<li><p><code>META-INF/service/</code> ç›®å½•ä¸‹ï¼ŒJava SPI çš„é…ç½®ç›®å½•ã€‚åœ¨ <a href="http://svip.iocoder.cn/Dubbo/spi/#" target="_blank" rel="noopener">ã€Œ4.2 åŠ è½½æ‹“å±•é…ç½®ã€</a> ä¸­ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ° Dubbo SPI å¯¹ Java SPI åšäº†<strong>å…¼å®¹</strong>ã€‚</p>
</li>
</ul>
</li>
<li><p>ç¬¬ 7 è¡Œï¼š<code>NAME_SEPARATOR</code> ï¼Œæ‹“å±•ååˆ†éš”ç¬¦ï¼Œä½¿ç”¨<strong>é€—å·</strong>ã€‚</p>
</li>
<li><p><strong>ç¬¬ 9 è‡³ 124 è¡Œ</strong>ï¼Œæˆ‘ä»¬å°†å±æ€§åˆ†æˆäº†ä¸¤ç±»ï¼š1ï¼‰é™æ€å±æ€§ï¼›2ï¼‰å¯¹è±¡å±æ€§ã€‚è¿™æ˜¯ä¸ºå•¥å‘¢ï¼Ÿ</p>
</li>
<li><p>ã€é™æ€å±æ€§ã€‘ä¸€æ–¹é¢ï¼ŒExtensionLoader æ˜¯ ExtensionLoader çš„<strong>ç®¡ç†å®¹å™¨</strong>ã€‚ä¸€ä¸ªæ‹“å±•( æ‹“å±•æ¥å£ )å¯¹åº”ä¸€ä¸ª ExtensionLoader å¯¹è±¡ã€‚ä¾‹å¦‚ï¼ŒProtocol å’Œ Filter <strong>åˆ†åˆ«</strong>å¯¹åº”ä¸€ä¸ª ExtensionLoader å¯¹è±¡ã€‚</p>
</li>
<li><p>ã€å¯¹è±¡å±æ€§ã€‘å¦ä¸€æ–¹é¢ï¼Œä¸€ä¸ªæ‹“å±•é€šè¿‡å…¶ ExtensionLoader å¯¹è±¡ï¼ŒåŠ è½½å®ƒçš„<strong>æ‹“å±•å®ç°ä»¬</strong>ã€‚æˆ‘ä»¬ä¼šå‘ç°å¤šä¸ªå±æ€§éƒ½æ˜¯ â€œ<strong>cached</strong>â€œ å¼€å¤´ã€‚ExtensionLoader è€ƒè™‘åˆ°æ€§èƒ½å’Œèµ„æºçš„ä¼˜åŒ–ï¼Œè¯»å–æ‹“å±•é…ç½®åï¼Œä¼šé¦–å…ˆè¿›è¡Œ<strong>ç¼“å­˜</strong>ã€‚ç­‰åˆ° Dubbo ä»£ç <strong>çœŸæ­£</strong>ç”¨åˆ°å¯¹åº”çš„æ‹“å±•å®ç°æ—¶ï¼Œè¿›è¡Œæ‹“å±•å®ç°çš„å¯¹è±¡çš„åˆå§‹åŒ–ã€‚å¹¶ä¸”ï¼Œåˆå§‹åŒ–å®Œæˆåï¼Œä¹Ÿä¼šè¿›è¡Œ<strong>ç¼“å­˜</strong>ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼š</p>
<ul>
<li>ç¼“å­˜åŠ è½½çš„æ‹“å±•é…ç½®</li>
<li>ç¼“å­˜åˆ›å»ºçš„æ‹“å±•å®ç°å¯¹è±¡</li>
</ul>
</li>
</ul>
<h3 id="4-2-è·å¾—æ‹“å±•é…ç½®"><a href="#4-2-è·å¾—æ‹“å±•é…ç½®" class="headerlink" title="4.2 è·å¾—æ‹“å±•é…ç½®"></a>4.2 è·å¾—æ‹“å±•é…ç½®</h3><h4 id="4-2-1-getExtensionClasses"><a href="#4-2-1-getExtensionClasses" class="headerlink" title="4.2.1 getExtensionClasses"></a>4.2.1 getExtensionClasses</h4><p><code>#getExtensionClasses()</code> æ–¹æ³•ï¼Œè·å¾—æ‹“å±•å®ç°ç±»æ•°ç»„ã€‚</p>
<pre><code class="java">private final Holder&lt;Map&lt;String, Class&lt;?&gt;&gt;&gt; cachedClasses = new Holder&lt;Map&lt;String, Class&lt;?&gt;&gt;&gt;();

private volatile Class&lt;?&gt; cachedAdaptiveClass = null;

private Set&lt;Class&lt;?&gt;&gt; cachedWrapperClasses;

  1: /**
  2:  * è·å¾—æ‹“å±•å®ç°ç±»æ•°ç»„
  3:  *
  4:  * @return æ‹“å±•å®ç°ç±»æ•°ç»„
  5:  */
  6: private Map&lt;String, Class&lt;?&gt;&gt; getExtensionClasses() {
  7:     // ä»ç¼“å­˜ä¸­ï¼Œè·å¾—æ‹“å±•å®ç°ç±»æ•°ç»„
  8:     Map&lt;String, Class&lt;?&gt;&gt; classes = cachedClasses.get();
  9:     if (classes == null) {
 10:         synchronized (cachedClasses) {
 11:             classes = cachedClasses.get();
 12:             if (classes == null) {
 13:                 // ä»é…ç½®æ–‡ä»¶ä¸­ï¼ŒåŠ è½½æ‹“å±•å®ç°ç±»æ•°ç»„
 14:                 classes = loadExtensionClasses();
 15:                 // è®¾ç½®åˆ°ç¼“å­˜ä¸­
 16:                 cachedClasses.set(classes);
 17:             }
 18:         }
 19:     }
 20:     return classes;
 21: }</code></pre>
<ul>
<li><p><code>cachedClasses</code> å±æ€§ï¼Œç¼“å­˜çš„æ‹“å±•å®ç°ç±»é›†åˆã€‚å®ƒä¸åŒ…å«å¦‚ä¸‹ä¸¤ç§ç±»å‹çš„æ‹“å±•å®ç°ï¼š</p>
<ul>
<li><p><strong>è‡ªé€‚åº”</strong>æ‹“å±•å®ç°ç±»ã€‚ä¾‹å¦‚ AdaptiveExtensionFactory ã€‚</p>
<ul>
<li>æ‹“å±• Adaptive å®ç°ç±»ï¼Œä¼šæ·»åŠ åˆ° <code>cachedAdaptiveClass</code> å±æ€§ä¸­ã€‚</li>
</ul>
</li>
<li><p>å¸¦<strong>å”¯ä¸€å‚æ•°ä¸ºæ‹“å±•æ¥å£</strong>çš„æ„é€ æ–¹æ³•çš„å®ç°ç±»ï¼Œæˆ–è€…è¯´æ‹“å±• Wrapper å®ç°ç±»ã€‚ä¾‹å¦‚  ProtocolFilterWrapper ã€‚</p>
<ul>
<li>æ‹“å±• Wrapper å®ç°ç±»ï¼Œä¼šæ·»åŠ åˆ° <code>cachedWrapperClasses</code> å±æ€§ä¸­ã€‚</li>
</ul>
</li>
<li><p>æ€»ç»“æ¥è¯´ï¼Œ<code>cachedClasses</code> + <code>cachedAdaptiveClass</code> + <code>cachedWrapperClasses</code> æ‰æ˜¯<strong>å®Œæ•´</strong>ç¼“å­˜çš„æ‹“å±•å®ç°ç±»çš„é…ç½®ã€‚</p>
</li>
</ul>
</li>
<li><p>ç¬¬ 7 è‡³ 11 è¡Œï¼šä»ç¼“å­˜ä¸­ï¼Œè·å¾—æ‹“å±•å®ç°ç±»æ•°ç»„ã€‚</p>
</li>
<li><p>ç¬¬ 12 è‡³ 14 è¡Œï¼šå½“ç¼“å­˜ä¸å­˜åœ¨æ—¶ï¼Œè°ƒç”¨ <code>#loadExtensionClasses()</code> æ–¹æ³•ï¼Œä»é…ç½®æ–‡ä»¶ä¸­ï¼ŒåŠ è½½æ‹“å±•å®ç°ç±»æ•°ç»„ã€‚</p>
</li>
<li><p>ç¬¬ 16 è¡Œï¼šè®¾ç½®åŠ è½½çš„å®ç°ç±»æ•°ç»„ï¼Œåˆ°ç¼“å­˜ä¸­ã€‚</p>
</li>
</ul>
<h4 id="4-2-2-loadExtensionClasses"><a href="#4-2-2-loadExtensionClasses" class="headerlink" title="4.2.2 loadExtensionClasses"></a>4.2.2 loadExtensionClasses</h4><p><code>#loadExtensionClasses()</code> æ–¹æ³•ï¼Œä»<strong>å¤šä¸ª</strong>é…ç½®æ–‡ä»¶ä¸­ï¼ŒåŠ è½½æ‹“å±•å®ç°ç±»æ•°ç»„ã€‚</p>
<pre><code class="java">1: /**
 2:  * åŠ è½½æ‹“å±•å®ç°ç±»æ•°ç»„
 3:  *
 4:  * æ— éœ€å£°æ˜ synchronized ï¼Œå› ä¸ºå”¯ä¸€è°ƒç”¨è¯¥æ–¹æ³•çš„ {@link #getExtensionClasses()} å·²ç»å£°æ˜ã€‚
 5:  * // synchronized in getExtensionClasses
 6:  *
 7:  * @return æ‹“å±•å®ç°ç±»æ•°ç»„
 8:  */
 9: private Map&lt;String, Class&lt;?&gt;&gt; loadExtensionClasses() {
10:     // é€šè¿‡ @SPI æ³¨è§£ï¼Œè·å¾—é»˜è®¤çš„æ‹“å±•å®ç°ç±»å
11:     final SPI defaultAnnotation = type.getAnnotation(SPI.class);
12:     if (defaultAnnotation != null) {
13:         String value = defaultAnnotation.value();
14:         if ((value = value.trim()).length() &gt; 0) {
15:             String[] names = NAME_SEPARATOR.split(value);
16:             if (names.length &gt; 1) {
17:                 throw new IllegalStateException(&quot;more than 1 default extension name on extension &quot; + type.getName()
18:                         + &quot;: &quot; + Arrays.toString(names));
19:             }
20:             if (names.length == 1) cachedDefaultName = names[0];
21:         }
22:     }
23: 
24:     // ä»é…ç½®æ–‡ä»¶ä¸­ï¼ŒåŠ è½½æ‹“å±•å®ç°ç±»æ•°ç»„
25:     Map&lt;String, Class&lt;?&gt;&gt; extensionClasses = new HashMap&lt;String, Class&lt;?&gt;&gt;();
26:     loadFile(extensionClasses, DUBBO_INTERNAL_DIRECTORY);
27:     loadFile(extensionClasses, DUBBO_DIRECTORY);
28:     loadFile(extensionClasses, SERVICES_DIRECTORY);
29:     return extensionClasses;
30: }</code></pre>
<ul>
<li>ç¬¬ 10 è‡³ 22 è¡Œï¼šé€šè¿‡ <code>@SPI</code> æ³¨è§£ï¼Œè·å¾—æ‹“å±•æ¥å£å¯¹åº”çš„<strong>é»˜è®¤çš„</strong>æ‹“å±•å®ç°ç±»åã€‚åœ¨ <a href="http://svip.iocoder.cn/Dubbo/spi/#" target="_blank" rel="noopener">ã€Œ5. @SPIã€</a> è¯¦ç»†è§£æã€‚</li>
<li>ç¬¬ 25 è‡³ 29 è¡Œï¼šè°ƒç”¨ <code>#loadFile(extensionClasses, dir)</code> æ–¹æ³•ï¼Œä»é…ç½®æ–‡ä»¶ä¸­ï¼ŒåŠ è½½æ‹“å±•å®ç°ç±»æ•°ç»„ã€‚<strong>æ³¨æ„</strong>ï¼Œæ­¤å¤„é…ç½®æ–‡ä»¶çš„åŠ è½½é¡ºåºã€‚</li>
</ul>
<h4 id="4-2-3-loadFile"><a href="#4-2-3-loadFile" class="headerlink" title="4.2.3 loadFile"></a>4.2.3 loadFile</h4><p><code>#loadFile(extensionClasses, dir)</code> æ–¹æ³•ï¼Œä»<strong>ä¸€ä¸ª</strong>é…ç½®æ–‡ä»¶ä¸­ï¼ŒåŠ è½½æ‹“å±•å®ç°ç±»æ•°ç»„ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="java">/**
 * ç¼“å­˜çš„è‡ªé€‚åº”æ‹“å±•å¯¹è±¡çš„ç±»
 *
 * {@link #getAdaptiveExtensionClass()}
 */
private volatile Class&lt;?&gt; cachedAdaptiveClass = null;

/**
 * æ‹“å±• Wrapper å®ç°ç±»é›†åˆ
 *
 * å¸¦å”¯ä¸€å‚æ•°ä¸ºæ‹“å±•æ¥å£çš„æ„é€ æ–¹æ³•çš„å®ç°ç±»
 *
 * é€šè¿‡ {@link #loadExtensionClasses} åŠ è½½
 */
private Set&lt;Class&lt;?&gt;&gt; cachedWrapperClasses;

/**
 * æ‹“å±•åä¸ @Activate çš„æ˜ å°„
 *
 * ä¾‹å¦‚ï¼ŒAccessLogFilterã€‚
 *
 * ç”¨äº {@link #getActivateExtension(URL, String)}
 */
private final Map&lt;String, Activate&gt; cachedActivates = new ConcurrentHashMap&lt;String, Activate&gt;();

/**
 * ç¼“å­˜çš„æ‹“å±•åä¸æ‹“å±•ç±»çš„æ˜ å°„ã€‚
 *
 * å’Œ {@link #cachedClasses} çš„ KV å¯¹è°ƒã€‚
 *
 * é€šè¿‡ {@link #loadExtensionClasses} åŠ è½½
 */
private final ConcurrentMap&lt;Class&lt;?&gt;, String&gt; cachedNames = new ConcurrentHashMap&lt;Class&lt;?&gt;, String&gt;();

/**
 * æ‹“å±•å ä¸ åŠ è½½å¯¹åº”æ‹“å±•ç±»å‘ç”Ÿçš„å¼‚å¸¸ çš„ æ˜ å°„
 *
 * keyï¼šæ‹“å±•å
 * valueï¼šå¼‚å¸¸
 *
 * åœ¨ {@link #loadFile(Map, String)} æ—¶ï¼Œè®°å½•
 */
private Map&lt;String, IllegalStateException&gt; exceptions = new ConcurrentHashMap&lt;String, IllegalStateException&gt;();

  1: /**
  2:  * ä»ä¸€ä¸ªé…ç½®æ–‡ä»¶ä¸­ï¼ŒåŠ è½½æ‹“å±•å®ç°ç±»æ•°ç»„ã€‚
  3:  *
  4:  * @param extensionClasses æ‹“å±•ç±»åæ•°ç»„
  5:  * @param dir æ–‡ä»¶å
  6:  */
  7: private void loadFile(Map&lt;String, Class&lt;?&gt;&gt; extensionClasses, String dir) {
  8:     // å®Œæ•´çš„æ–‡ä»¶å
  9:     String fileName = dir + type.getName();
 10:     try {
 11:         Enumeration&lt;java.net.URL&gt; urls;
 12:         // è·å¾—æ–‡ä»¶åå¯¹åº”çš„æ‰€æœ‰æ–‡ä»¶æ•°ç»„
 13:         ClassLoader classLoader = findClassLoader();
 14:         if (classLoader != null) {
 15:             urls = classLoader.getResources(fileName);
 16:         } else {
 17:             urls = ClassLoader.getSystemResources(fileName);
 18:         }
 19:         // éå†æ–‡ä»¶æ•°ç»„
 20:         if (urls != null) {
 21:             while (urls.hasMoreElements()) {
 22:                 java.net.URL url = urls.nextElement();
 23:                 try {
 24:                     BufferedReader reader = new BufferedReader(new InputStreamReader(url.openStream(), &quot;utf-8&quot;));
 25:                     try {
 26:                         String line;
 27:                         while ((line = reader.readLine()) != null) {
 28:                             // è·³è¿‡å½“å‰è¢«æ³¨é‡Šæ‰çš„æƒ…å†µï¼Œä¾‹å¦‚ #spring=xxxxxxxxx
 29:                             final int ci = line.indexOf(&#39;#&#39;);
 30:                             if (ci &gt;= 0) line = line.substring(0, ci);
 31:                             line = line.trim();
 32:                             if (line.length() &gt; 0) {
 33:                                 try {
 34:                                     // æ‹†åˆ†ï¼Œkey=value çš„é…ç½®æ ¼å¼
 35:                                     String name = null;
 36:                                     int i = line.indexOf(&#39;=&#39;);
 37:                                     if (i &gt; 0) {
 38:                                         name = line.substring(0, i).trim();
 39:                                         line = line.substring(i + 1).trim();
 40:                                     }
 41:                                     if (line.length() &gt; 0) {
 42:                                         // åˆ¤æ–­æ‹“å±•å®ç°ï¼Œæ˜¯å¦å®ç°æ‹“å±•æ¥å£
 43:                                         Class&lt;?&gt; clazz = Class.forName(line, true, classLoader);
 44:                                         if (!type.isAssignableFrom(clazz)) {
 45:                                             throw new IllegalStateException(&quot;Error when load extension class(interface: &quot; +
 46:                                                     type + &quot;, class line: &quot; + clazz.getName() + &quot;), class &quot;
 47:                                                     + clazz.getName() + &quot;is not subtype of interface.&quot;);
 48:                                         }
 49:                                         // ç¼“å­˜è‡ªé€‚åº”æ‹“å±•å¯¹è±¡çš„ç±»åˆ° `cachedAdaptiveClass`
 50:                                         if (clazz.isAnnotationPresent(Adaptive.class)) {
 51:                                             if (cachedAdaptiveClass == null) {
 52:                                                 cachedAdaptiveClass = clazz;
 53:                                             } else if (!cachedAdaptiveClass.equals(clazz)) {
 54:                                                 throw new IllegalStateException(&quot;More than 1 adaptive class found: &quot;
 55:                                                         + cachedAdaptiveClass.getClass().getName()
 56:                                                         + &quot;, &quot; + clazz.getClass().getName());
 57:                                             }
 58:                                         } else {
 59:                                             // ç¼“å­˜æ‹“å±• Wrapper å®ç°ç±»åˆ° `cachedWrapperClasses`
 60:                                             try {
 61:                                                 clazz.getConstructor(type);
 62:                                                 Set&lt;Class&lt;?&gt;&gt; wrappers = cachedWrapperClasses;
 63:                                                 if (wrappers == null) {
 64:                                                     cachedWrapperClasses = new ConcurrentHashSet&lt;Class&lt;?&gt;&gt;();
 65:                                                     wrappers = cachedWrapperClasses;
 66:                                                 }
 67:                                                 wrappers.add(clazz);
 68:                                             // ç¼“å­˜æ‹“å±•å®ç°ç±»åˆ° `extensionClasses`
 69:                                             } catch (NoSuchMethodException e) {
 70:                                                 clazz.getConstructor();
 71:                                                 // æœªé…ç½®æ‹“å±•åï¼Œè‡ªåŠ¨ç”Ÿæˆã€‚ä¾‹å¦‚ï¼ŒDemoFilter ä¸º demo ã€‚ä¸»è¦ç”¨äºå…¼å®¹ Java SPI çš„é…ç½®ã€‚
 72:                                                 if (name == null || name.length() == 0) {
 73:                                                     name = findAnnotationName(clazz);
 74:                                                     if (name == null || name.length() == 0) {
 75:                                                         if (clazz.getSimpleName().length() &gt; type.getSimpleName().length()
 76:                                                                 &amp;&amp; clazz.getSimpleName().endsWith(type.getSimpleName())) {
 77:                                                             name = clazz.getSimpleName().substring(0, clazz.getSimpleName().length() - type.getSimpleName().length()).toLowerCase();
 78:                                                         } else {
 79:                                                             throw new IllegalStateException(&quot;No such extension name for the class &quot; + clazz.getName() + &quot; in the config &quot; + url);
 80:                                                         }
 81:                                                     }
 82:                                                 }
 83:                                                 // è·å¾—æ‹“å±•åï¼Œå¯ä»¥æ˜¯æ•°ç»„ï¼Œæœ‰å¤šä¸ªæ‹“å±•åã€‚
 84:                                                 String[] names = NAME_SEPARATOR.split(name);
 85:                                                 if (names != null &amp;&amp; names.length &gt; 0) {
 86:                                                     // ç¼“å­˜ @Activate åˆ° `cachedActivates` ã€‚
 87:                                                     Activate activate = clazz.getAnnotation(Activate.class);
 88:                                                     if (activate != null) {
 89:                                                         cachedActivates.put(names[0], activate);
 90:                                                     }
 91:                                                     for (String n : names) {
 92:                                                         // ç¼“å­˜åˆ° `cachedNames`
 93:                                                         if (!cachedNames.containsKey(clazz)) {
 94:                                                             cachedNames.put(clazz, n);
 95:                                                         }
 96:                                                         // ç¼“å­˜æ‹“å±•å®ç°ç±»åˆ° `extensionClasses`
 97:                                                         Class&lt;?&gt; c = extensionClasses.get(n);
 98:                                                         if (c == null) {
 99:                                                             extensionClasses.put(n, clazz);
100:                                                         } else if (c != clazz) {
101:                                                             throw new IllegalStateException(&quot;Duplicate extension &quot; + type.getName() + &quot; name &quot; + n + &quot; on &quot; + c.getName() + &quot; and &quot; + clazz.getName());
102:                                                         }
103:                                                     }
104:                                                 }
105:                                             }
106:                                         }
107:                                     }
108:                                 } catch (Throwable t) {
109:                                     // å‘ç”Ÿå¼‚å¸¸ï¼Œè®°å½•åˆ°å¼‚å¸¸é›†åˆ
110:                                     IllegalStateException e = new IllegalStateException(&quot;Failed to load extension class(interface: &quot; + type + &quot;, class line: &quot; + line + &quot;) in &quot; + url + &quot;, cause: &quot; + t.getMessage(), t);
111:                                     exceptions.put(line, e);
112:                                 }
113:                             }
114:                         } // end of while read lines
115:                     } finally {
116:                         reader.close();
117:                     }
118:                 } catch (Throwable t) {
119:                     logger.error(&quot;Exception when load extension class(interface: &quot; +
120:                             type + &quot;, class file: &quot; + url + &quot;) in &quot; + url, t);
121:                 }
122:             } // end of while urls
123:         }
124:     } catch (Throwable t) {
125:         logger.error(&quot;Exception when load extension class(interface: &quot; +
126:                 type + &quot;, description file: &quot; + fileName + &quot;).&quot;, t);
127:     }
128: }</code></pre>
<ul>
<li><p>ç¬¬ 9 è¡Œï¼šè·å¾—å®Œæ•´çš„æ–‡ä»¶å( ç›¸å¯¹è·¯å¾„ )ã€‚ä¾‹å¦‚ï¼š<code>&quot;META-INF/dubbo/internal/com.alibaba.dubbo.common.extension.ExtensionFactory&quot;</code> ã€‚</p>
</li>
<li><p>ç¬¬ 12 è‡³ 18 è¡Œï¼šè·å¾—æ–‡ä»¶åå¯¹åº”çš„æ‰€æœ‰æ–‡ä»¶ URL æ•°ç»„ã€‚ä¾‹å¦‚ï¼š<img src="/Users/ocean/Downloads/04.png" alt="ExtensionFactory çš„é…ç½®æ–‡ä»¶"></p>
</li>
<li><p>ç¬¬ 21 è‡³ 24 è¡Œï¼šé€ä¸ª<strong>æ–‡ä»¶</strong> URL éå†ã€‚</p>
</li>
<li><p>ç¬¬ 27 è¡Œï¼šé€<strong>è¡Œ</strong>éå†ã€‚</p>
</li>
<li><p>ç¬¬ 29 è‡³ 32 è¡Œï¼šè·³è¿‡å½“å‰è¢« <code>&quot;#&quot;</code> æ³¨é‡Šæ‰çš„æƒ…å†µï¼Œä¾‹å¦‚ <code>#spring=xxxxxxxxx</code> ã€‚</p>
</li>
<li><p>ç¬¬ 34 è‡³ 40 è¡Œï¼šæŒ‰ç…§ <code>key=value</code> çš„é…ç½®æ‹†åˆ†ã€‚å…¶ä¸­ <code>name</code> ä¸ºæ‹“å±•åï¼Œ<code>line</code> ä¸ºæ‹“å±•å®ç°ç±»åã€‚<strong>æ³¨æ„</strong>ï¼Œä¸Šæ–‡æˆ‘ä»¬æåˆ°è¿‡ Dubbo SPI ä¼šå…¼å®¹ Java SPI çš„é…ç½®æ ¼å¼ï¼Œé‚£ä¹ˆæŒ‰ç…§æ­¤å¤„çš„è§£ææ–¹å¼ï¼Œ<code>name</code> ä¼šä¸ºç©ºã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ‹“å±•åä¼šè‡ªåŠ¨ç”Ÿæˆï¼Œè¯¦ç»†è§ç¬¬ 71 è‡³ 82 è¡Œçš„ä»£ç ã€‚</p>
</li>
<li><p>ç¬¬ 42 è‡³ 48 è¡Œï¼šåˆ¤æ–­æ‹“å±•å®ç°ç±»ï¼Œéœ€è¦å®ç°æ‹“å±•æ¥å£ã€‚</p>
</li>
<li><p>ç¬¬ 50 è‡³ 57 è¡Œï¼šç¼“å­˜è‡ªé€‚åº”æ‹“å±•å¯¹è±¡çš„ç±»åˆ° <code>cachedAdaptiveClass</code> å±æ€§ã€‚åœ¨ <a href="http://svip.iocoder.cn/Dubbo/spi/#" target="_blank" rel="noopener">ã€Œ6. @Adaptiveã€</a> è¯¦ç»†è§£æã€‚</p>
</li>
<li><p>ç¬¬ 59 è‡³ 67 è¡Œï¼šç¼“å­˜æ‹“å±• Wrapper å®ç°ç±»åˆ° <code>cachedWrapperClasses</code> å±æ€§ã€‚</p>
<ul>
<li><p>ç¬¬ 61 è¡Œï¼šè°ƒç”¨ <code>Class#getConstructor(Class... parameterTypes)</code> æ–¹æ³•ï¼Œé€šè¿‡<strong>åå°„</strong>çš„æ–¹å¼ï¼Œå‚æ•°ä¸ºæ‹“å±•æ¥å£ï¼Œåˆ¤æ–­å½“å‰é…ç½®çš„æ‹“å±•å®ç°ç±»ä¸º<strong>æ‹“å±• Wrapper å®ç°ç±»</strong>ã€‚è‹¥æˆåŠŸï¼ˆæœªæŠ›å‡ºå¼‚å¸¸ï¼‰ï¼Œåˆ™ä»£è¡¨ç¬¦åˆæ¡ä»¶ã€‚ä¾‹å¦‚ï¼Œ<a href="https://github.com/alibaba/dubbo/blob/master/dubbo-rpc/dubbo-rpc-api/src/main/java/com/alibaba/dubbo/rpc/protocol/ProtocolFilterWrapper.java#L39-L44" target="_blank" rel="noopener">ProtocolFilterWrapper(Protocol protocol)</a> è¿™ä¸ªæ„é€ æ–¹æ³•ã€‚</p>
<ul>
<li><pre><code class="java">public ProtocolFilterWrapper(Protocol protocol) {
        if (protocol == null) {
            throw new IllegalArgumentException(&quot;protocol == null&quot;);
        }
        this.protocol = protocol;
    }</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li><p>ç¬¬ 69 è‡³ 105 è¡Œï¼šè‹¥è·å¾—æ„é€ æ–¹æ³•å¤±è´¥ï¼Œåˆ™ä»£è¡¨æ˜¯æ™®é€šçš„æ‹“å±•å®ç°ç±»ï¼Œç¼“å­˜åˆ° <code>extensionClasses</code> <strong>å˜é‡</strong>ä¸­ã€‚</p>
<ul>
<li>ç¬¬ 70 è¡Œï¼šè°ƒç”¨ <code>Class#getConstructor(Class... parameterTypes)</code> æ–¹æ³•ï¼Œè·å¾—å‚æ•°ä¸ºç©ºçš„æ„é€ æ–¹æ³•ã€‚</li>
<li>ç¬¬ 72 è‡³ 82 è¡Œï¼šæœªé…ç½®æ‹“å±•åï¼Œè‡ªåŠ¨ç”Ÿæˆã€‚<strong>é€‚ç”¨äº Java SPI çš„é…ç½®æ–¹å¼</strong>ã€‚ä¾‹å¦‚ï¼Œxxx.yyy.DemoFilter ç”Ÿæˆçš„æ‹“å±•åä¸º <code>demo</code> ã€‚<ul>
<li>ç¬¬ 73 è¡Œï¼šé€šè¿‡ <code>@Extension</code> æ³¨è§£çš„æ–¹å¼è®¾ç½®æ‹“å±•åçš„æ–¹å¼å·²ç»<strong>åºŸå¼ƒ</strong>ï¼Œèƒ–å‹å¯ä»¥æ— è§†è¯¥æ–¹æ³•ã€‚</li>
</ul>
</li>
</ul>
</li>
<li><p>ç¬¬ 84 è¡Œï¼šè·å¾—æ‹“å±•åã€‚ä½¿ç”¨é€—å·è¿›è¡Œåˆ†å‰²ï¼Œå³å¤šä¸ªæ‹“å±•åå¯ä»¥å¯¹åº”åŒä¸€ä¸ªæ‹“å±•å®ç°ç±»ã€‚</p>
</li>
<li><p>ç¬¬ 86 è‡³ 90 è¡Œï¼šç¼“å­˜ <code>@Activate</code> åˆ° <code>cachedActivates</code> ã€‚åœ¨ <a href="http://svip.iocoder.cn/Dubbo/spi/#" target="_blank" rel="noopener">ã€Œ7. @Activateã€</a> è¯¦ç»†è§£æã€‚</p>
</li>
<li><p>ç¬¬ 93 è‡³ 95 è¡Œï¼šç¼“å­˜åˆ° <code>cachedNames</code> å±æ€§ã€‚</p>
</li>
<li><p>ç¬¬ 96 è‡³ 102 è¡Œï¼šç¼“å­˜æ‹“å±•å®ç°ç±»åˆ° <code>extensionClasses</code> å˜é‡ã€‚<strong>æ³¨æ„</strong>ï¼Œç›¸åŒæ‹“å±•åï¼Œä¸èƒ½å¯¹åº”å¤šä¸ªä¸åŒçš„æ‹“å±•å®ç°(SPIåå­—çš„æ‰©å±•ååªèƒ½æœ‰ä¸€ä¸ª)ã€‚</p>
</li>
<li><p>ç¬¬ 108 è‡³ 112 è¡Œï¼šè‹¥å‘ç”Ÿå¼‚å¸¸ï¼Œè®°å½•åˆ°å¼‚å¸¸é›†åˆ <code>exceptions</code> å±æ€§ã€‚</p>
</li>
</ul>
<h4 id="4-2-4-å…¶ä»–æ–¹æ³•"><a href="#4-2-4-å…¶ä»–æ–¹æ³•" class="headerlink" title="4.2.4 å…¶ä»–æ–¹æ³•"></a>4.2.4 å…¶ä»–æ–¹æ³•</h4><p>å¦‚ä¸‹æ–¹æ³•ï¼Œå’Œè¯¥æµç¨‹æ— å…³ï¼Œèƒ–å‹å¯è‡ªè¡ŒæŸ¥çœ‹ã€‚</p>
<ul>
<li><a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L537-L546" target="_blank" rel="noopener"><code>#getExtensionClass(name)</code></a></li>
<li><a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L459-L482" target="_blank" rel="noopener"><code>#findException(name)</code></a></li>
<li><a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L129-L131" target="_blank" rel="noopener"><code>#getExtensionName(extensionInstance)</code></a></li>
<li><a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L133-L135" target="_blank" rel="noopener"><code>#getExtensionName(extensionClass)</code></a></li>
<li><a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L277-L286" target="_blank" rel="noopener"><code>#getSupportedExtensions()</code></a></li>
<li><a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L344-L350" target="_blank" rel="noopener"><code>#getDefaultExtensionName()</code></a></li>
<li><a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L337" target="_blank" rel="noopener"><code>#hasExtension(name)</code></a></li>
</ul>
<h3 id="4-3-è·å¾—æ‹“å±•åŠ è½½å™¨"><a href="#4-3-è·å¾—æ‹“å±•åŠ è½½å™¨" class="headerlink" title="4.3 è·å¾—æ‹“å±•åŠ è½½å™¨"></a>4.3 è·å¾—æ‹“å±•åŠ è½½å™¨</h3><p>åœ¨ Dubbo çš„ä»£ç é‡Œï¼Œå¸¸å¸¸èƒ½çœ‹åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š</p>
<pre><code class="java">ExtensionLoader.getExtensionLoader(Protocol.class).getExtension(name)</code></pre>
<h4 id="4-3-1-getExtensionLoader"><a href="#4-3-1-getExtensionLoader" class="headerlink" title="4.3.1 getExtensionLoader"></a>4.3.1 getExtensionLoader</h4><p><code>#getExtensionLoader(Class&lt;T&gt; type)</code> <strong>é™æ€</strong>æ–¹æ³•ï¼Œæ ¹æ®æ‹“å±•ç‚¹çš„æ¥å£ï¼Œè·å¾—æ‹“å±•åŠ è½½å™¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="java">/**
 * æ‹“å±•åŠ è½½å™¨é›†åˆ
 *
 * keyï¼šæ‹“å±•æ¥å£
 */
 // ã€é™æ€å±æ€§ã€‘
private static final ConcurrentMap&lt;Class&lt;?&gt;, ExtensionLoader&lt;?&gt;&gt; EXTENSION_LOADERS = new ConcurrentHashMap&lt;Class&lt;?&gt;, ExtensionLoader&lt;?&gt;&gt;(); 

  1: /**
  2:  * æ ¹æ®æ‹“å±•ç‚¹çš„æ¥å£ï¼Œè·å¾—æ‹“å±•åŠ è½½å™¨
  3:  *
  4:  * @param type æ¥å£
  5:  * @param &lt;T&gt; æ³›å‹
  6:  * @return åŠ è½½å™¨
  7:  */
  8: @SuppressWarnings(&quot;unchecked&quot;)
  9: public static &lt;T&gt; ExtensionLoader&lt;T&gt; getExtensionLoader(Class&lt;T&gt; type) {
 10:     if (type == null)
 11:         throw new IllegalArgumentException(&quot;Extension type == null&quot;);
 12:     // å¿…é¡»æ˜¯æ¥å£
 13:     if (!type.isInterface()) {
 14:         throw new IllegalArgumentException(&quot;Extension type(&quot; + type + &quot;) is not interface!&quot;);
 15:     }
 16:     // å¿…é¡»åŒ…å« @SPI æ³¨è§£
 17:     if (!withExtensionAnnotation(type)) {
 18:         throw new IllegalArgumentException(&quot;Extension type(&quot; + type +
 19:                 &quot;) is not extension, because WITHOUT @&quot; + SPI.class.getSimpleName() + &quot; Annotation!&quot;);
 20:     }
 21: 
 22:     // è·å¾—æ¥å£å¯¹åº”çš„æ‹“å±•ç‚¹åŠ è½½å™¨
 23:     ExtensionLoader&lt;T&gt; loader = (ExtensionLoader&lt;T&gt;) EXTENSION_LOADERS.get(type);
 24:     if (loader == null) {
 25:         EXTENSION_LOADERS.putIfAbsent(type, new ExtensionLoader&lt;T&gt;(type));
 26:         loader = (ExtensionLoader&lt;T&gt;) EXTENSION_LOADERS.get(type);
 27:     }
 28: }</code></pre>
<ul>
<li>ç¬¬ 12 è‡³ 15 è¡Œï¼šå¿…é¡»æ˜¯æ¥å£ã€‚</li>
<li>ç¬¬ 16 è‡³ 20 è¡Œï¼šè°ƒç”¨ <a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L101-L103" target="_blank" rel="noopener"><code>#withExtensionAnnotation()</code></a> æ–¹æ³•ï¼Œæ ¡éªŒå¿…é¡»ä½¿ç”¨ <code>@SPI</code> æ³¨è§£æ ‡è®°ã€‚</li>
<li>ç¬¬ 22 è‡³ 27 è¡Œï¼šä» <code>EXTENSION_LOADERS</code> <strong>é™æ€</strong>ä¸­è·å–æ‹“å±•æ¥å£å¯¹åº”çš„ ExtensionLoader å¯¹è±¡ã€‚è‹¥ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»º ExtensionLoader å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ° <code>EXTENSION_LOADERS</code>ã€‚</li>
</ul>
<h4 id="4-3-2-æ„é€ æ–¹æ³•"><a href="#4-3-2-æ„é€ æ–¹æ³•" class="headerlink" title="4.3.2 æ„é€ æ–¹æ³•"></a>4.3.2 æ„é€ æ–¹æ³•</h4><p>æ„é€ æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="java">/**
 * æ‹“å±•æ¥å£ã€‚
 * ä¾‹å¦‚ï¼ŒProtocol
 */
private final Class&lt;?&gt; type;
/**
 * å¯¹è±¡å·¥å‚
 *
 * ç”¨äºè°ƒç”¨ {@link #injectExtension(Object)} æ–¹æ³•ï¼Œå‘æ‹“å±•å¯¹è±¡æ³¨å…¥ä¾èµ–å±æ€§ã€‚
 *
 * ä¾‹å¦‚ï¼ŒStubProxyFactoryWrapper ä¸­æœ‰ `Protocol protocol` å±æ€§ã€‚
 */
private final ExtensionFactory objectFactory;

  1: private ExtensionLoader(Class&lt;?&gt; type) {
  2:     this.type = type;
  3:     objectFactory = (type == ExtensionFactory.class ? null : ExtensionLoader.getExtensionLoader(ExtensionFactory.class).getAdaptiveExtension());
  4: }</code></pre>
<p><code>objectFactory</code> å±æ€§ï¼Œå¯¹è±¡å·¥å‚ï¼Œ<strong>åŠŸèƒ½ä¸Šå’Œ Spring IOC ä¸€è‡´</strong>ã€‚</p>
<ul>
<li>ç”¨äºè°ƒç”¨ <a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L510-L535" target="_blank" rel="noopener"><code>#injectExtension(instance)</code></a> æ–¹æ³•æ—¶ï¼Œå‘åˆ›å»ºçš„æ‹“å±•æ³¨å…¥å…¶ä¾èµ–çš„å±æ€§ã€‚ä¾‹å¦‚ï¼Œ<a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-filter/dubbo-filter-cache/src/main/java/com/alibaba/dubbo/cache/filter/CacheFilter.java#L38" target="_blank" rel="noopener"><code>CacheFilter.cacheFactory</code></a> å±æ€§ã€‚</li>
<li>ç¬¬ 3 è¡Œï¼šå½“æ‹“å±•æ¥å£é ExtensionFactory æ—¶( å¦‚æœä¸åŠ è¿™ä¸ªåˆ¤æ–­ï¼Œä¼šæ˜¯ä¸€ä¸ªæ­»å¾ªç¯ )ï¼Œè°ƒç”¨ <code>ExtensionLoader#getAdaptiveExtension()</code> æ–¹æ³•ï¼Œè·å¾— ExtensionFactory æ‹“å±•æ¥å£çš„<strong>è‡ªé€‚åº”</strong>æ‹“å±•å®ç°å¯¹è±¡ã€‚<strong>ä¸ºä»€ä¹ˆå‘¢</strong>ï¼Ÿåœ¨ <a href="http://svip.iocoder.cn/Dubbo/spi/#" target="_blank" rel="noopener">ã€Œ8. ExtensionFactoryã€</a> è¯¦ç»†è§£æã€‚</li>
</ul>
<h3 id="4-4-è·å¾—æŒ‡å®šæ‹“å±•å¯¹è±¡"><a href="#4-4-è·å¾—æŒ‡å®šæ‹“å±•å¯¹è±¡" class="headerlink" title="4.4 è·å¾—æŒ‡å®šæ‹“å±•å¯¹è±¡"></a>4.4 è·å¾—æŒ‡å®šæ‹“å±•å¯¹è±¡</h3><p>åœ¨ Dubbo çš„ä»£ç é‡Œï¼Œå¸¸å¸¸èƒ½çœ‹åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š</p>
<pre><code class="java">ExtensionLoader.getExtensionLoader(Protocol.class).getExtension(name)</code></pre>
<h4 id="4-4-1-getExtension"><a href="#4-4-1-getExtension" class="headerlink" title="4.4.1 getExtension"></a>4.4.1 getExtension</h4><pre><code class="java">/**
 * ç¼“å­˜çš„æ‹“å±•å¯¹è±¡é›†åˆ
 *
 * keyï¼šæ‹“å±•å
 * valueï¼šæ‹“å±•å¯¹è±¡
 *
 * ä¾‹å¦‚ï¼ŒProtocol æ‹“å±•
 *          keyï¼šdubbo valueï¼šDubboProtocol
 *          keyï¼šinjvm valueï¼šInjvmProtocol
 *
 * é€šè¿‡ {@link #loadExtensionClasses} åŠ è½½
 */
private final ConcurrentMap&lt;String, Holder&lt;Object&gt;&gt; cachedInstances = new ConcurrentHashMap&lt;String, Holder&lt;Object&gt;&gt;();

  1: /**
  2:  * Find the extension with the given name. If the specified name is not found, then {@link IllegalStateException}
  3:  * will be thrown.
  4:  */
  5: /**
  6:  * è¿”å›æŒ‡å®šåå­—çš„æ‰©å±•å¯¹è±¡ã€‚å¦‚æœæŒ‡å®šåå­—çš„æ‰©å±•ä¸å­˜åœ¨ï¼Œåˆ™æŠ›å¼‚å¸¸ {@link IllegalStateException}.
  7:  *
  8:  * @param name æ‹“å±•å
  9:  * @return æ‹“å±•å¯¹è±¡
 10:  */
 11: @SuppressWarnings(&quot;unchecked&quot;)
 12: public T getExtension(String name) {
 13:     if (name == null || name.length() == 0)
 14:         throw new IllegalArgumentException(&quot;Extension name == null&quot;);
 15:     // æŸ¥æ‰¾ é»˜è®¤çš„ æ‹“å±•å¯¹è±¡
 16:     if (&quot;true&quot;.equals(name)) {
 17:         return getDefaultExtension();
 18:     }
 19:     // ä» ç¼“å­˜ä¸­ è·å¾—å¯¹åº”çš„æ‹“å±•å¯¹è±¡
 20:     Holder&lt;Object&gt; holder = cachedInstances.get(name);
 21:     if (holder == null) {
 22:         cachedInstances.putIfAbsent(name, new Holder&lt;Object&gt;());
 23:         holder = cachedInstances.get(name);
 24:     }
 25:     Object instance = holder.get();
 26:     if (instance == null) {
 27:         synchronized (holder) {
 28:             instance = holder.get();
 29:             // ä» ç¼“å­˜ä¸­ æœªè·å–åˆ°ï¼Œè¿›è¡Œåˆ›å»ºç¼“å­˜å¯¹è±¡ã€‚
 30:             if (instance == null) {
 31:                 instance = createExtension(name);
 32:                 // è®¾ç½®åˆ›å»ºå¯¹è±¡åˆ°ç¼“å­˜ä¸­
 33:                 holder.set(instance);
 34:             }
 35:         }
 36:     }
 37:     return (T) instance;
 38: }</code></pre>
<ul>
<li>ç¬¬ 15 è‡³ 18 è¡Œï¼šè°ƒç”¨ <code>#getDefaultExtension()</code> æ–¹æ³•ï¼ŒæŸ¥è¯¢<strong>é»˜è®¤çš„</strong>æ‹“å±•å¯¹è±¡ã€‚åœ¨è¯¥æ–¹æ³•çš„å®ç°ä»£ç ä¸­ï¼Œç®€åŒ–ä»£ç ä¸º <code>getExtension(cachedDefaultName);</code> ã€‚</li>
<li>ç¬¬ 19 è‡³ 28 è¡Œï¼šä»ç¼“å­˜ä¸­ï¼Œè·å¾—æ‹“å±•å¯¹è±¡ã€‚</li>
<li>ç¬¬ 29 è‡³ 31 è¡Œï¼šå½“ç¼“å­˜ä¸å­˜åœ¨æ—¶ï¼Œè°ƒç”¨ <code>#createExtension(name)</code> æ–¹æ³•ï¼Œåˆ›å»ºæ‹“å±•å¯¹è±¡ã€‚</li>
<li>ç¬¬ 33 è¡Œï¼šæ·»åŠ åˆ›å»ºçš„æ‹“å±•å¯¹è±¡ï¼Œåˆ°ç¼“å­˜ä¸­ã€‚</li>
</ul>
<h4 id="4-4-2-createExtension"><a href="#4-4-2-createExtension" class="headerlink" title="4.4.2 createExtension"></a>4.4.2 createExtension</h4><p><code>#createExtension(name)</code> æ–¹æ³•ï¼Œåˆ›å»ºæ‹“å±•åçš„æ‹“å±•å¯¹è±¡ï¼Œå¹¶ç¼“å­˜ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="java">/**
 * æ‹“å±•å®ç°ç±»é›†åˆ
 *
 * keyï¼šæ‹“å±•å®ç°ç±»
 * valueï¼šæ‹“å±•å¯¹è±¡ã€‚
 *
 * ä¾‹å¦‚ï¼Œkey ä¸º Class&lt;AccessLogFilter&gt;
 *      value ä¸º AccessLogFilter å¯¹è±¡
 */
private static final ConcurrentMap&lt;Class&lt;?&gt;, Object&gt; EXTENSION_INSTANCES = new ConcurrentHashMap&lt;Class&lt;?&gt;, Object&gt;();

  1: /**
  2:  * åˆ›å»ºæ‹“å±•åçš„æ‹“å±•å¯¹è±¡ï¼Œå¹¶ç¼“å­˜ã€‚
  3:  *
  4:  * @param name æ‹“å±•å
  5:  * @return æ‹“å±•å¯¹è±¡
  6:  */
  7: @SuppressWarnings(&quot;unchecked&quot;)
  8: private T createExtension(String name) {
  9:     // è·å¾—æ‹“å±•åå¯¹åº”çš„æ‹“å±•å®ç°ç±»
 10:     Class&lt;?&gt; clazz = getExtensionClasses().get(name);
 11:     if (clazz == null) {
 12:         throw findException(name); // æŠ›å‡ºå¼‚å¸¸
 13:     }
 14:     try {
 15:         // ä»ç¼“å­˜ä¸­ï¼Œè·å¾—æ‹“å±•å¯¹è±¡ã€‚
 16:         T instance = (T) EXTENSION_INSTANCES.get(clazz);
 17:         if (instance == null) {
 18:             // å½“ç¼“å­˜ä¸å­˜åœ¨æ—¶ï¼Œåˆ›å»ºæ‹“å±•å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ°ç¼“å­˜ä¸­ã€‚
 19:             EXTENSION_INSTANCES.putIfAbsent(clazz, clazz.newInstance());
 20:             instance = (T) EXTENSION_INSTANCES.get(clazz);
 21:         }
 22:         // æ³¨å…¥ä¾èµ–çš„å±æ€§
 23:         injectExtension(instance);
 24:         // åˆ›å»º Wrapper æ‹“å±•å¯¹è±¡
 25:         Set&lt;Class&lt;?&gt;&gt; wrapperClasses = cachedWrapperClasses;
 26:         if (wrapperClasses != null &amp;&amp; !wrapperClasses.isEmpty()) {
 27:             for (Class&lt;?&gt; wrapperClass : wrapperClasses) {
 28:                 instance = injectExtension((T) wrapperClass.getConstructor(type).newInstance(instance));
 29:             }
 30:         }
 31:         return instance;
 32:     } catch (Throwable t) {
 33:         throw new IllegalStateException(&quot;Extension instance(name: &quot; + name + &quot;, class: &quot; +
 34:                 type + &quot;)  could not be instantiated: &quot; + t.getMessage(), t);
 35:     }
 36: }</code></pre>
<ul>
<li>ç¬¬ 9 è‡³ 13 è¡Œï¼šè·å¾—æ‹“å±•åå¯¹åº”çš„æ‹“å±•å®ç°ç±»ã€‚è‹¥ä¸å­˜åœ¨ï¼Œè°ƒç”¨ <code>#findException(name)</code> æ–¹æ³•ï¼ŒæŠ›å‡ºå¼‚å¸¸ã€‚</li>
<li>ç¬¬ 16 è¡Œï¼šä»ç¼“å­˜ <code>EXTENSION_INSTANCES</code> <strong>é™æ€</strong>å±æ€§ä¸­ï¼Œè·å¾—æ‹“å±•å¯¹è±¡ã€‚</li>
<li>ç¬¬ 17 è‡³ 21 è¡Œï¼šå½“ç¼“å­˜ä¸å­˜åœ¨æ—¶ï¼Œåˆ›å»ºæ‹“å±•å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ° <code>EXTENSION_INSTANCES</code> ä¸­ã€‚å› ä¸º <code>#getExtension(name)</code> æ–¹æ³•ä¸­å·²ç»åŠ  <code>synchronized</code> ä¿®é¥°ï¼Œæ‰€ä»¥æ­¤å¤„ä¸ç”¨åŒæ­¥ã€‚</li>
<li>ç¬¬ 23 è¡Œï¼šè°ƒç”¨ <code>#injectExtension(instance)</code> æ–¹æ³•ï¼Œå‘åˆ›å»ºçš„æ‹“å±•æ³¨å…¥å…¶ä¾èµ–çš„å±æ€§ã€‚</li>
<li>ç¬¬ 24 è‡³ 30 è¡Œï¼šåˆ›å»º Wrapper æ‹“å±•å¯¹è±¡ï¼Œå°† <code>instance</code> <strong>åŒ…è£…åœ¨å…¶ä¸­</strong>ã€‚åœ¨ <a href="http://dubbo.apache.org/zh-cn/docs/dev/SPI.html" target="_blank" rel="noopener">ã€ŠDubbo å¼€å‘æŒ‡å— â€”â€” æ‰©å±•ç‚¹åŠ è½½ã€‹</a> æ–‡ç« ä¸­ï¼Œå¦‚æ­¤ä»‹ç» Wrapper ç±»ï¼š</li>
</ul>
<blockquote>
<p>Wrapper ç±»åŒæ ·å®ç°äº†æ‰©å±•ç‚¹æ¥å£ï¼Œä½†æ˜¯ Wrapper ä¸æ˜¯æ‰©å±•ç‚¹çš„çœŸæ­£å®ç°ã€‚å®ƒçš„ç”¨é€”ä¸»è¦æ˜¯ç”¨äºä» ExtensionLoader è¿”å›æ‰©å±•ç‚¹æ—¶ï¼ŒåŒ…è£…åœ¨çœŸæ­£çš„æ‰©å±•ç‚¹å®ç°å¤–ã€‚å³ä» ExtensionLoader ä¸­è¿”å›çš„å®é™…ä¸Šæ˜¯ Wrapper ç±»çš„å®ä¾‹ï¼ŒWrapper æŒæœ‰äº†å®é™…çš„æ‰©å±•ç‚¹å®ç°ç±»ã€‚</p>
<p>æ‰©å±•ç‚¹çš„ Wrapper ç±»å¯ä»¥æœ‰å¤šä¸ªï¼Œä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦æ–°å¢ã€‚</p>
<p>é€šè¿‡ Wrapper ç±»å¯ä»¥æŠŠæ‰€æœ‰æ‰©å±•ç‚¹å…¬å…±é€»è¾‘ç§»è‡³ Wrapper ä¸­ã€‚æ–°åŠ çš„ Wrapper åœ¨æ‰€æœ‰çš„æ‰©å±•ç‚¹ä¸Šæ·»åŠ äº†é€»è¾‘ï¼Œæœ‰äº›ç±»ä¼¼ AOPï¼Œå³ Wrapper ä»£ç†äº†æ‰©å±•ç‚¹ã€‚</p>
</blockquote>
<h4 id="4-4-3-injectExtension"><a href="#4-4-3-injectExtension" class="headerlink" title="4.4.3 injectExtension"></a>4.4.3 injectExtension</h4><p><code>#injectExtension(instance)</code> æ–¹æ³•ï¼Œæ³¨å…¥ä¾èµ–çš„å±æ€§ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="java">1: /**
 2:  * æ³¨å…¥ä¾èµ–çš„å±æ€§
 3:  *
 4:  * @param instance æ‹“å±•å¯¹è±¡
 5:  * @return æ‹“å±•å¯¹è±¡
 6:  */
 7: private T injectExtension(T instance) {
 8:     try {
 9:         if (objectFactory != null) {
10:             for (Method method : instance.getClass().getMethods()) {
11:                 if (method.getName().startsWith(&quot;set&quot;)
12:                         &amp;&amp; method.getParameterTypes().length == 1
13:                         &amp;&amp; Modifier.isPublic(method.getModifiers())) { // setting &amp;&amp; public æ–¹æ³•
14:                     // è·å¾—å±æ€§çš„ç±»å‹
15:                     Class&lt;?&gt; pt = method.getParameterTypes()[0];
16:                     try {
17:                         // è·å¾—å±æ€§
18:                         String property = method.getName().length() &gt; 3 ? method.getName().substring(3, 4).toLowerCase() + method.getName().substring(4) : &quot;&quot;;
19:                         // è·å¾—å±æ€§å€¼
20:                         Object object = objectFactory.getExtension(pt, property);
21:                         // è®¾ç½®å±æ€§å€¼
22:                         if (object != null) {
23:                             method.invoke(instance, object);
24:                         }
25:                     } catch (Exception e) {
26:                         logger.error(&quot;fail to inject via method &quot; + method.getName()
27:                                 + &quot; of interface &quot; + type.getName() + &quot;: &quot; + e.getMessage(), e);
28:                     }
29:                 }
30:             }
31:         }
32:     } catch (Exception e) {
33:         logger.error(e.getMessage(), e);
34:     }
35:     return instance;
36: }</code></pre>
<ul>
<li>ç¬¬ 9 è¡Œï¼šå¿…é¡»æœ‰ <code>objectFactory</code> å±æ€§ï¼Œå³ ExtensionFactory çš„æ‹“å±•å¯¹è±¡ï¼Œä¸éœ€è¦æ³¨å…¥ä¾èµ–çš„å±æ€§ã€‚</li>
<li>ç¬¬ 10 è‡³ 13 è¡Œï¼šåå°„è·å¾—æ‰€æœ‰çš„æ–¹æ³•ï¼Œä»…ä»…å¤„ç† <code>public setting</code> æ–¹æ³•ã€‚</li>
<li>ç¬¬ 15 è¡Œï¼šè·å¾—å±æ€§çš„ç±»å‹ã€‚</li>
<li>ç¬¬ 18 è¡Œï¼šè·å¾—å±æ€§åã€‚</li>
<li>ç¬¬ 20 è¡Œï¼šè·å¾—<strong>å±æ€§å€¼</strong>ã€‚<strong>æ³¨æ„</strong>ï¼Œæ­¤å¤„è™½ç„¶è°ƒç”¨çš„æ˜¯ <code>ExtensionFactory#getExtension(type, name)</code> æ–¹æ³•ï¼Œå®é™…è·å–çš„ä¸ä»…ä»…æ˜¯æ‹“å±•å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥æ˜¯ Spring Bean å¯¹è±¡ã€‚ç­”æ¡ˆåœ¨ <a href="http://svip.iocoder.cn/Dubbo/spi/#" target="_blank" rel="noopener">ã€Œ8. ExtensionFactoryã€</a> æ­æ™“ã€‚</li>
<li>ç¬¬ 21 è‡³ 24 è¡Œï¼šè®¾ç½®å±æ€§å€¼ã€‚</li>
</ul>
<h4 id="4-4-4-å…¶ä»–æ–¹æ³•"><a href="#4-4-4-å…¶ä»–æ–¹æ³•" class="headerlink" title="4.4.4 å…¶ä»–æ–¹æ³•"></a>4.4.4 å…¶ä»–æ–¹æ³•</h4><p>å¦‚ä¸‹æ–¹æ³•ï¼Œå’Œè¯¥æµç¨‹æ— å…³ï¼Œèƒ–å‹å¯è‡ªè¡ŒæŸ¥çœ‹ã€‚</p>
<ul>
<li><a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L257-L275" target="_blank" rel="noopener"><code>#getLoadedExtension(name)</code></a></li>
<li><a href="https://github.com/YunaiV/dubbo/blob/6b8e51ac55880a0f10a34f297d0869fcdbb42369/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L277-L286" target="_blank" rel="noopener"><code>#getLoadedExtensions()</code></a></li>
</ul>
<h3 id="4-5-è·å¾—è‡ªé€‚åº”çš„æ‹“å±•å¯¹è±¡"><a href="#4-5-è·å¾—è‡ªé€‚åº”çš„æ‹“å±•å¯¹è±¡" class="headerlink" title="4.5 è·å¾—è‡ªé€‚åº”çš„æ‹“å±•å¯¹è±¡"></a>4.5 è·å¾—è‡ªé€‚åº”çš„æ‹“å±•å¯¹è±¡</h3><p>åœ¨ Dubbo çš„ä»£ç é‡Œï¼Œå¸¸å¸¸èƒ½çœ‹åˆ°å¦‚ä¸‹çš„ä»£ç ï¼š</p>
<pre><code class="java">ExtensionLoader.getExtensionLoader(Protocol.class).getAdaptiveExtension()</code></pre>
<blockquote>
<p>å‹æƒ…æç¤ºï¼Œå…ˆçœ‹ä¸‹ <a href="http://svip.iocoder.cn/Dubbo/spi/#" target="_blank" rel="noopener">ã€Œ6. Adaptiveã€</a> çš„å†…å®¹ï¼Œåœ¨å›åˆ°æ­¤å¤„ã€‚</p>
</blockquote>
<h4 id="4-5-1-getAdaptiveExtension"><a href="#4-5-1-getAdaptiveExtension" class="headerlink" title="4.5.1 getAdaptiveExtension"></a>4.5.1 getAdaptiveExtension</h4><p><code>#getAdaptiveExtension()</code> æ–¹æ³•ï¼Œè·å¾—è‡ªé€‚åº”æ‹“å±•å¯¹è±¡ã€‚</p>
<pre><code class="java">/**
 * ç¼“å­˜çš„è‡ªé€‚åº”( Adaptive )æ‹“å±•å¯¹è±¡
 */
private final Holder&lt;Object&gt; cachedAdaptiveInstance = new Holder&lt;Object&gt;();

/**
 * åˆ›å»º {@link #cachedAdaptiveInstance} æ—¶å‘ç”Ÿçš„å¼‚å¸¸ã€‚
 *
 * å‘ç”Ÿå¼‚å¸¸åï¼Œä¸å†åˆ›å»ºï¼Œå‚è§ {@link #createAdaptiveExtension()}
 */
private volatile Throwable createAdaptiveInstanceError;

  1: /**
  2:  * è·å¾—è‡ªé€‚åº”æ‹“å±•å¯¹è±¡
  3:  *
  4:  * @return æ‹“å±•å¯¹è±¡
  5:  */
  6: @SuppressWarnings(&quot;unchecked&quot;)
  7: public T getAdaptiveExtension() {
  8:     // ä»ç¼“å­˜ä¸­ï¼Œè·å¾—è‡ªé€‚åº”æ‹“å±•å¯¹è±¡
  9:     Object instance = cachedAdaptiveInstance.get();
 10:     if (instance == null) {
 11:         // è‹¥ä¹‹å‰æœªåˆ›å»ºæŠ¥é”™ï¼Œ
 12:         if (createAdaptiveInstanceError == null) {
 13:             synchronized (cachedAdaptiveInstance) {
 14:                 instance = cachedAdaptiveInstance.get();
 15:                 if (instance == null) {
 16:                     try {
 17:                         // åˆ›å»ºè‡ªé€‚åº”æ‹“å±•å¯¹è±¡
 18:                         instance = createAdaptiveExtension();
 19:                         // è®¾ç½®åˆ°ç¼“å­˜
 20:                         cachedAdaptiveInstance.set(instance);
 21:                     } catch (Throwable t) {
 22:                         // è®°å½•å¼‚å¸¸
 23:                         createAdaptiveInstanceError = t;
 24:                         throw new IllegalStateException(&quot;fail to create adaptive instance: &quot; + t.toString(), t);
 25:                     }
 26:                 }
 27:             }
 28:         // è‹¥ä¹‹å‰åˆ›å»ºæŠ¥é”™ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ IllegalStateException
 29:         } else {
 30:             throw new IllegalStateException(&quot;fail to create adaptive instance: &quot; + createAdaptiveInstanceError.toString(), createAdaptiveInstanceError);
 31:         }
 32:     }
 33:     return (T) instance;
 34: }</code></pre>
<ul>
<li>ç¬¬ 9 è¡Œï¼šä»ç¼“å­˜ <code>cachedAdaptiveInstance</code> å±æ€§ä¸­ï¼Œè·å¾—è‡ªé€‚åº”æ‹“å±•å¯¹è±¡ã€‚</li>
<li>ç¬¬ 28 è‡³ 30 è¡Œï¼šè‹¥ä¹‹å‰åˆ›å»ºæŠ¥é”™ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ IllegalStateException ã€‚</li>
<li>ç¬¬ 14 è‡³ 20 è¡Œï¼šå½“ç¼“å­˜ä¸å­˜åœ¨æ—¶ï¼Œè°ƒç”¨ <code>#createAdaptiveExtension()</code> æ–¹æ³•ï¼Œåˆ›å»ºè‡ªé€‚åº”æ‹“å±•å¯¹è±¡ï¼Œå¹¶æ·»åŠ åˆ° <code>cachedAdaptiveInstance</code> ä¸­ã€‚</li>
<li>ç¬¬ 22 è‡³ 24 è¡Œï¼šè‹¥åˆ›å»ºå‘ç”Ÿå¼‚å¸¸ï¼Œè®°å½•å¼‚å¸¸åˆ° <code>createAdaptiveInstanceError</code> ï¼Œå¹¶æŠ›å‡ºå¼‚å¸¸ IllegalStateException ã€‚</li>
</ul>
<h4 id="4-5-2-createAdaptiveExtension"><a href="#4-5-2-createAdaptiveExtension" class="headerlink" title="4.5.2 createAdaptiveExtension"></a>4.5.2 createAdaptiveExtension</h4><p><code>#createAdaptiveExtension()</code> æ–¹æ³•ï¼Œåˆ›å»ºè‡ªé€‚åº”æ‹“å±•å¯¹è±¡ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="java">/**
 * åˆ›å»ºè‡ªé€‚åº”æ‹“å±•å¯¹è±¡
 *
 * @return æ‹“å±•å¯¹è±¡
 */
@SuppressWarnings(&quot;unchecked&quot;)
private T createAdaptiveExtension() {
    try {
        return injectExtension((T) getAdaptiveExtensionClass().newInstance());
    } catch (Exception e) {
        throw new IllegalStateException(&quot;Can not create adaptive extension &quot; + type + &quot;, cause: &quot; + e.getMessage(), e);
    }
}</code></pre>
<ul>
<li>è°ƒç”¨ <code>#getAdaptiveExtensionClass()</code> æ–¹æ³•ï¼Œè·å¾—è‡ªé€‚åº”æ‹“å±•ç±»ã€‚</li>
<li>è°ƒç”¨ <code>Class#newInstance()</code> æ–¹æ³•ï¼Œåˆ›å»ºè‡ªé€‚åº”æ‹“å±•å¯¹è±¡ã€‚</li>
<li>è°ƒç”¨ <code>#injectExtension(instance)</code> æ–¹æ³•ï¼Œå‘åˆ›å»ºçš„è‡ªé€‚åº”æ‹“å±•å¯¹è±¡ï¼Œæ³¨å…¥ä¾èµ–çš„å±æ€§ã€‚</li>
</ul>
<h4 id="4-5-3-getAdaptiveExtensionClass"><a href="#4-5-3-getAdaptiveExtensionClass" class="headerlink" title="4.5.3 getAdaptiveExtensionClass"></a>4.5.3 getAdaptiveExtensionClass</h4><p><code>#getAdaptiveExtensionClass()</code> æ–¹æ³•ï¼Œè·å¾—è‡ªé€‚åº”æ‹“å±•ç±»ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="java">1: /**
 2:  * @return è‡ªé€‚åº”æ‹“å±•ç±»
 3:  */
 4: private Class&lt;?&gt; getAdaptiveExtensionClass() {
 5:     getExtensionClasses();
 6:     if (cachedAdaptiveClass != null) {
 7:         return cachedAdaptiveClass;
 8:     }
 9:     return cachedAdaptiveClass = createAdaptiveExtensionClass();
10: }</code></pre>
<ul>
<li>ã€<code>@Adaptive</code> çš„ç¬¬ä¸€ç§ã€‘ç¬¬ 6 è‡³ 8 è¡Œï¼šè‹¥ <code>cachedAdaptiveClass</code> å·²å­˜åœ¨ï¼Œç›´æ¥è¿”å›ã€‚çš„ç¬¬ä¸€ç§æƒ…å†µã€‚</li>
<li>ã€<code>@Adaptive</code> çš„ç¬¬äºŒç§ã€‘ç¬¬ 9 è¡Œï¼šè°ƒç”¨ <code>#createAdaptiveExtensionClass()</code> æ–¹æ³•ï¼Œ<strong>è‡ªåŠ¨ç”Ÿæˆ</strong>è‡ªé€‚åº”æ‹“å±•çš„ä»£ç å®ç°ï¼Œå¹¶<strong>ç¼–è¯‘</strong>åè¿”å›è¯¥ç±»ã€‚</li>
</ul>
<h4 id="4-5-4-createAdaptiveExtensionClassCode"><a href="#4-5-4-createAdaptiveExtensionClassCode" class="headerlink" title="4.5.4 createAdaptiveExtensionClassCode"></a>4.5.4 createAdaptiveExtensionClassCode</h4><p><code>#createAdaptiveExtensionClassCode()</code> æ–¹æ³•ï¼Œè‡ªåŠ¨ç”Ÿæˆè‡ªé€‚åº”æ‹“å±•çš„ä»£ç å®ç°ï¼Œå¹¶ç¼–è¯‘åè¿”å›è¯¥ç±»ã€‚</p>
<pre><code class="java">1: /**
 2:  * è‡ªåŠ¨ç”Ÿæˆè‡ªé€‚åº”æ‹“å±•çš„ä»£ç å®ç°ï¼Œå¹¶ç¼–è¯‘åè¿”å›è¯¥ç±»ã€‚
 3:  *
 4:  * @return ç±»
 5:  */
 6: private Class&lt;?&gt; createAdaptiveExtensionClass() {
 7:     // è‡ªåŠ¨ç”Ÿæˆè‡ªé€‚åº”æ‹“å±•çš„ä»£ç å®ç°çš„å­—ç¬¦ä¸²
 8:     String code = createAdaptiveExtensionClassCode();
 9:     // ç¼–è¯‘ä»£ç ï¼Œå¹¶è¿”å›è¯¥ç±»
10:     ClassLoader classLoader = findClassLoader();
11:     com.alibaba.dubbo.common.compiler.Compiler compiler = ExtensionLoader.getExtensionLoader(com.alibaba.dubbo.common.compiler.Compiler.class).getAdaptiveExtension();
12:     return compiler.compile(code, classLoader);
13: }</code></pre>
<p>ç¬¬ 8 è¡Œï¼šè°ƒç”¨ <a href="https://github.com/YunaiV/dubbo/blob/4a877ee283af70c3f6a19c3b8b8e6918696540e6/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L1012-L1253" target="_blank" rel="noopener"><code>#createAdaptiveExtensionClassCode</code></a> æ–¹æ³•ï¼Œè‡ªåŠ¨ç”Ÿæˆè‡ªé€‚åº”æ‹“å±•çš„ä»£ç å®ç°çš„å­—ç¬¦ä¸²ã€‚</p>
<ul>
<li><p>å¦‚ä¸‹æ˜¯ ProxyFactory çš„è‡ªé€‚åº”æ‹“å±•çš„ä»£ç å®ç°çš„å­—ç¬¦ä¸²ç”Ÿæˆ<strong>ä¾‹å­</strong></p>
<p><img src="/Users/ocean/Downloads/05.png" alt="è‡ªé€‚åº”æ‹“å±•çš„ä»£ç å®ç°çš„å­—ç¬¦ä¸²ç”Ÿæˆä¾‹å­"></p>
</li>
<li><p>ç¬¬ 9 è‡³ 12 è¡Œï¼šä½¿ç”¨ Dubbo SPI åŠ è½½ Compier æ‹“å±•æ¥å£å¯¹åº”çš„æ‹“å±•å®ç°å¯¹è±¡ï¼Œåè°ƒç”¨ <code>Compiler#compile(code, classLoader)</code> æ–¹æ³•ï¼Œè¿›è¡Œç¼–è¯‘ã€‚</p>
</li>
</ul>
<h3 id="4-6-è·å¾—æ¿€æ´»çš„æ‹“å±•å¯¹è±¡æ•°ç»„"><a href="#4-6-è·å¾—æ¿€æ´»çš„æ‹“å±•å¯¹è±¡æ•°ç»„" class="headerlink" title="4.6 è·å¾—æ¿€æ´»çš„æ‹“å±•å¯¹è±¡æ•°ç»„"></a>4.6 è·å¾—æ¿€æ´»çš„æ‹“å±•å¯¹è±¡æ•°ç»„</h3><p>åœ¨ Dubbo çš„ä»£ç é‡Œï¼Œçœ‹åˆ°ä½¿ç”¨ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="java">List&lt;Filter&gt; filters = ExtensionLoader.getExtensionLoader(Filter.class).getActivateExtension(invoker.getUrl(), key, group);</code></pre>
<h4 id="4-6-1-getExtensionLoader"><a href="#4-6-1-getExtensionLoader" class="headerlink" title="4.6.1 getExtensionLoader"></a>4.6.1 getExtensionLoader</h4><p><code>#getExtensionLoader(url, key, group)</code> æ–¹æ³•ï¼Œè·å¾—ç¬¦åˆè‡ªåŠ¨æ¿€æ´»æ¡ä»¶çš„æ‹“å±•å¯¹è±¡æ•°ç»„ã€‚</p>
<pre><code class="java">1: /**
 2:  * This is equivalent to {@code getActivateExtension(url, url.getParameter(key).split(&quot;,&quot;), null)}
 3:  *
 4:  * è·å¾—ç¬¦åˆè‡ªåŠ¨æ¿€æ´»æ¡ä»¶çš„æ‹“å±•å¯¹è±¡æ•°ç»„
 5:  *
 6:  * @param url   url
 7:  * @param key   url parameter key which used to get extension point names
 8:  *              Dubbo URL å‚æ•°å
 9:  * @param group group
10:  *              è¿‡æ»¤åˆ†ç»„å
11:  * @return extension list which are activated.
12:  * @see #getActivateExtension(com.alibaba.dubbo.common.URL, String[], String)
13:  */
14: public List&lt;T&gt; getActivateExtension(URL url, String key, String group) {
15:     // ä» Dubbo URL è·å¾—å‚æ•°å€¼
16:     String value = url.getParameter(key);
17:     // è·å¾—ç¬¦åˆè‡ªåŠ¨æ¿€æ´»æ¡ä»¶çš„æ‹“å±•å¯¹è±¡æ•°ç»„
18:     return getActivateExtension(url, value == null || value.length() == 0 ? null : Constants.COMMA_SPLIT_PATTERN.split(value), group);
19: }
20: 
21: /**
22:  * Get activate extensions.
23:  *
24:  * è·å¾—ç¬¦åˆè‡ªåŠ¨æ¿€æ´»æ¡ä»¶çš„æ‹“å±•å¯¹è±¡æ•°ç»„
25:  *
26:  * @param url    url
27:  * @param values extension point names
28:  * @param group  group
29:  * @return extension list which are activated
30:  * @see com.alibaba.dubbo.common.extension.Activate
31:  */
32: public List&lt;T&gt; getActivateExtension(URL url, String[] values, String group) {
33:     List&lt;T&gt; exts = new ArrayList&lt;T&gt;();
34:     List&lt;String&gt; names = values == null ? new ArrayList&lt;String&gt;(0) : Arrays.asList(values);
35:     // å¤„ç†è‡ªåŠ¨æ¿€æ´»çš„æ‹“å±•å¯¹è±¡ä»¬
36:     // åˆ¤æ–­ä¸å­˜åœ¨é…ç½® `&quot;-name&quot;` ã€‚ä¾‹å¦‚ï¼Œ&lt;dubbo:service filter=&quot;-default&quot; /&gt; ï¼Œä»£è¡¨ç§»é™¤æ‰€æœ‰é»˜è®¤è¿‡æ»¤å™¨ã€‚
37:     if (!names.contains(Constants.REMOVE_VALUE_PREFIX + Constants.DEFAULT_KEY)) {
38:         // è·å¾—æ‹“å±•å®ç°ç±»æ•°ç»„
39:         getExtensionClasses();
40:         // å¾ªç¯
41:         for (Map.Entry&lt;String, Activate&gt; entry : cachedActivates.entrySet()) {
42:             String name = entry.getKey();
43:             Activate activate = entry.getValue();
44:             if (isMatchGroup(group, activate.group())) { // åŒ¹é…åˆ†ç»„
45:                 // è·å¾—æ‹“å±•å¯¹è±¡
46:                 T ext = getExtension(name);
47:                 if (!names.contains(name) // ä¸åŒ…å«åœ¨è‡ªå®šä¹‰é…ç½®é‡Œã€‚å¦‚æœåŒ…å«ï¼Œä¼šåœ¨ä¸‹é¢çš„ä»£ç å¤„ç†ã€‚
48:                         &amp;&amp; !names.contains(Constants.REMOVE_VALUE_PREFIX + name) // åˆ¤æ–­æ˜¯å¦é…ç½®ç§»é™¤ã€‚ä¾‹å¦‚ &lt;dubbo:service filter=&quot;-monitor&quot; /&gt;ï¼Œåˆ™ MonitorFilter ä¼šè¢«ç§»é™¤
49:                         &amp;&amp; isActive(activate, url)) { // åˆ¤æ–­æ˜¯å¦æ¿€æ´»
50:                     exts.add(ext);
51:                 }
52:             }
53:         }
54:         // æ’åº
55:         Collections.sort(exts, ActivateComparator.COMPARATOR);
56:     }
57:     // å¤„ç†è‡ªå®šä¹‰é…ç½®çš„æ‹“å±•å¯¹è±¡ä»¬ã€‚ä¾‹å¦‚åœ¨ &lt;dubbo:service filter=&quot;demo&quot; /&gt; ï¼Œä»£è¡¨éœ€è¦åŠ å…¥ DemoFilter ï¼ˆè¿™ä¸ªæ˜¯ç¬”è€…è‡ªå®šä¹‰çš„ï¼‰ã€‚
58:     List&lt;T&gt; usrs = new ArrayList&lt;T&gt;();
59:     for (int i = 0; i &lt; names.size(); i++) {
60:         String name = names.get(i);
61:         if (!name.startsWith(Constants.REMOVE_VALUE_PREFIX) &amp;&amp; !names.contains(Constants.REMOVE_VALUE_PREFIX + name)) { // åˆ¤æ–­éç§»é™¤çš„
62:             // å°†é…ç½®çš„è‡ªå®šä¹‰åœ¨è‡ªåŠ¨æ¿€æ´»çš„æ‹“å±•å¯¹è±¡ä»¬å‰é¢ã€‚ä¾‹å¦‚ï¼Œ&lt;dubbo:service filter=&quot;demo,default,demo2&quot; /&gt; ï¼Œåˆ™ DemoFilter å°±ä¼šæ”¾åœ¨é»˜è®¤çš„è¿‡æ»¤å™¨å‰é¢ã€‚
63:             if (Constants.DEFAULT_KEY.equals(name)) {
64:                 if (!usrs.isEmpty()) {
65:                     exts.addAll(0, usrs);
66:                     usrs.clear();
67:                 }
68:             } else {
69:                 // è·å¾—æ‹“å±•å¯¹è±¡
70:                 T ext = getExtension(name);
71:                 usrs.add(ext);
72:             }
73:         }
74:     }
75:     // æ·»åŠ åˆ°ç»“æœé›†
76:     if (!usrs.isEmpty()) {
77:         exts.addAll(usrs);
78:     }
79:     return exts;
80: }</code></pre>
<ul>
<li>ç¬¬ 16 è¡Œï¼šä» Dubbo URL è·å¾—å‚æ•°å€¼ã€‚ä¾‹å¦‚è¯´ï¼Œè‹¥ XML é…ç½® Service <code>&lt;dubbo:service filter=&quot;demo, demo2&quot; /&gt;</code> ï¼Œå¹¶ä¸”åœ¨è·å¾— Filter è‡ªåŠ¨æ¿€æ´»æ‹“å±•æ—¶ï¼Œæ­¤å¤„å°±èƒ½è§£æåˆ° <code>value=demo,demo2</code> ã€‚å¦å¤–ï¼Œ<code>value</code> å¯ä»¥æ ¹æ®<strong>é€—å·</strong>æ‹†åˆ†ã€‚</li>
<li>ç¬¬ 18 è¡Œï¼šè°ƒç”¨ <code>#getActivateExtension(url, values, group)</code> æ–¹æ³•ï¼Œè·å¾—ç¬¦åˆè‡ªåŠ¨æ¿€æ´»æ¡ä»¶çš„æ‹“å±•å¯¹è±¡æ•°ç»„ã€‚</li>
<li>ç¬¬ 35 è‡³ 56 è¡Œï¼šå¤„ç†è‡ªåŠ¨æ¿€æ´»çš„æ‹“å±•å¯¹è±¡ä»¬ã€‚<ul>
<li><a href="https://github.com/YunaiV/dubbo/blob/4a877ee283af70c3f6a19c3b8b8e6918696540e6/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L357-L378" target="_blank" rel="noopener"><code>#isMatchGroup(group, groups)</code></a> æ–¹æ³•ï¼ŒåŒ¹é…åˆ†ç»„ã€‚</li>
<li><a href="https://github.com/YunaiV/dubbo/blob/4a877ee283af70c3f6a19c3b8b8e6918696540e6/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/ExtensionLoader.java#L380-L403" target="_blank" rel="noopener"><code>#isActive(Activate, url)</code></a> æ–¹æ³•ï¼Œæ˜¯å¦æ¿€æ´»ï¼Œé€šè¿‡ Dubbo URL ä¸­æ˜¯å¦å­˜åœ¨å‚æ•°åä¸º [<code>@Activate.value](mailto:</code>@Activate.value)` ï¼Œå¹¶ä¸”å‚æ•°å€¼éç©ºã€‚</li>
</ul>
</li>
<li>ç¬¬ 57 è‡³ 74 è¡Œï¼šå¤„ç†è‡ªå®šä¹‰é…ç½®çš„æ‹“å±•å¯¹è±¡ä»¬ã€‚</li>
<li>ç¬¬ 75 è‡³ 78 è¡Œï¼šå°† <code>usrs</code> åˆå¹¶åˆ° <code>exts</code> <strong>å°¾éƒ¨</strong>ã€‚</li>
</ul>
<h3 id="4-6-2-ActivateComparator"><a href="#4-6-2-ActivateComparator" class="headerlink" title="4.6.2 ActivateComparator"></a>4.6.2 ActivateComparator</h3><p><a href="https://github.com/YunaiV/dubbo/blob/4a877ee283af70c3f6a19c3b8b8e6918696540e6/dubbo-common/src/main/java/com/alibaba/dubbo/common/extension/support/ActivateComparator.java" target="_blank" rel="noopener"><code>com.alibaba.dubbo.common.extension.support.ActivateComparator</code></a> ï¼Œè‡ªåŠ¨æ¿€æ´»æ‹“å±•å¯¹è±¡æ’åºå™¨ã€‚</p>

      
       <hr><span style="font-style: italic;color: gray;"> è½¬è½½è¯·æ³¨æ˜æ¥æºï¼Œæ¬¢è¿å¯¹æ–‡ç« ä¸­çš„å¼•ç”¨æ¥æºè¿›è¡Œè€ƒè¯ï¼Œæ¬¢è¿æŒ‡å‡ºä»»ä½•æœ‰é”™è¯¯æˆ–ä¸å¤Ÿæ¸…æ™°çš„è¡¨è¾¾ã€‚å¯ä»¥åœ¨ä¸‹é¢è¯„è®ºåŒºè¯„è®ºï¼Œä¹Ÿå¯ä»¥é‚®ä»¶è‡³ 729535228@qq.com </span>
    </div>
</article>


<p>
    <a  class="dashang" onclick="dashangToggle()">èµ</a>
</p>


<div class="article_copyright">
    <p><span class="copy-title">æ–‡ç« æ ‡é¢˜:</span>dubboSPIè¯¦è§£</p>
    <p><span class="copy-title">æ–‡ç« å­—æ•°:</span><span class="post-count">7.6k</span></p>
    <p><span class="copy-title">æœ¬æ–‡ä½œè€…:</span><a  title="Ocean Bai">Ocean Bai</a></p>
    <p><span class="copy-title">å‘å¸ƒæ—¶é—´:</span>2020-02-17, 14:41:31</p>
    <p><span class="copy-title">æœ€åæ›´æ–°:</span>2020-02-17, 17:15:07</p>
    <span class="copy-title">åŸå§‹é“¾æ¥:</span><a class="post-url" href="/2020/02/17/dubbo/dubboSPI/" title="dubboSPIè¯¦è§£">http://yoursite.com/2020/02/17/dubbo/dubboSPI/</a>
    <p>
        <span class="copy-title">ç‰ˆæƒå£°æ˜:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="CC BY-NC-SA 4.0 International" target = "_blank">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚
    </p>
</div>








    </div>
    <div class="copyright">
        <p class="footer-entry">Â©2019-2020 Ocean</p>
<p class="footer-entry">Built with <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/yelog/hexo-theme-3-hexo" target="_blank">3-hexo</a> theme</p>

    </div>
    <div class="full-toc">
        <button class="full"><span class="min "></span></button>
<button class="post-toc-menu"><span class="post-toc-menu-icons"></span></button>
<div class="post-toc"><span class="post-toc-title">ç›®å½•</span>
    <div class="post-toc-content">

    </div>
</div>
<a class="" id="rocket" ></a>

    </div>
</div>
<div class="acParent"></div>

<div class="hide_box" onclick="dashangToggle()"></div>
<div class="shang_box">
    <a class="shang_close"  onclick="dashangToggle()">Ã—</a>
    <div class="shang_tit">
        <p>å–œæ¬¢å°±ç‚¹èµ,ç–¼çˆ±å°±æ‰“èµ</p>
    </div>
    <div class="shang_payimg">
        <div class="pay_img">
            <img src="/img/alipay.jpg" class="alipay" title="æ‰«ç æ”¯æŒ">
            <img src="/img/weixin.jpg" class="weixin" title="æ‰«ç æ”¯æŒ">
        </div>
    </div>
    <div class="shang_payselect">
        <span><label><input type="radio" name="pay" checked value="alipay">æ”¯ä»˜å®</label></span><span><label><input type="radio" name="pay" value="weixin">å¾®ä¿¡</label></span>
    </div>
</div>


</body>
<script src="/js/jquery.pjax.js?v=1.0.1" ></script>

<script src="/js/script.js?v=1.0.1" ></script>
<script>
    var img_resize = 'default';
    /*ä½œè€…ã€æ ‡ç­¾çš„è‡ªåŠ¨è¡¥å…¨*/
    $(function () {
        $('.search').AutoComplete({
            'data': ['#åŠ¨æ€ä»£ç†','#SPI','#é¢è¯•','#åƒåœ¾','#ç±»åŠ è½½å™¨','#ç¼“å­˜','#ç®—æ³•','#åå°„','#è®¾è®¡æ¨¡å¼','#å·¥å‚æ¨¡å¼','#æ€»ç»“é¢è¯•','#è®¾è®¡åŸåˆ™','#jdk','#çº¿ç¨‹æ± ',],
            'itemHeight': 20,
            'width': 418
        }).AutoComplete('show');
    })
    function initArticle() {
        /*æ¸²æŸ“å¯¹åº”çš„è¡¨æ ¼æ ·å¼*/
        
            $(".post .pjax table").addClass("green_title");
        

        /*æ¸²æŸ“æ‰“èµæ ·å¼*/
        
        $("input[name=pay]").on("click", function () {
            if($("input[name=pay]:checked").val()=="weixin"){
                $(".shang_box .shang_payimg .pay_img").addClass("weixin_img");
            } else {
                $(".shang_box .shang_payimg .pay_img").removeClass("weixin_img");
            }
        })
        

        /*é«˜äº®ä»£ç å—è¡Œå·*/
        
        $('pre code').each(function(){
            var lines = $(this).text().split('\n').length - 1, widther='';
            if (lines>99) {
                widther = 'widther'
            }
            var $numbering = $('<ul/>').addClass('pre-numbering ' + widther).attr("unselectable","on");
            $(this).addClass('has-numbering ' + widther)
                    .parent()
                    .append($numbering);
            for(var i=1;i<=lines;i++){
                $numbering.append($('<li/>').text(i));
            }
        });
        

        /*è®¿é—®æ•°é‡*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*ä»£ç é«˜äº®ï¼Œè¡Œå·å¯¹é½*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
        /* æ¸²æŸ“*/
        function HTMLDecode(text) {
            var temp = document.createElement("div");
            temp.innerHTML = text;
            var output = temp.innerText || temp.textContent;
            temp = null;
            return output;
        }
        if (window.mermaid){
            window.mermaid = null
        }
        $.getScript("//cdn.jsdelivr.net/npm/mermaid@8.4.2/dist/mermaid.min.js", function () {
            var mermaidOptions = JSON.parse(HTMLDecode("{&#34;theme&#34;:&#34;default&#34;,&#34;startOnLoad&#34;:true,&#34;flowchart&#34;:{&#34;useMaxWidth&#34;:false,&#34;htmlLabels&#34;:true}}"))
            if (window.mermaid) {
                mermaid.initialize(mermaidOptions)
                mermaid.contentLoaded()
            }
        })
        
    }

    /*æ‰“èµé¡µé¢éšè—ä¸å±•ç¤º*/
    
    function dashangToggle() {
        $(".shang_box").fadeToggle();
        $(".hide_box").fadeToggle();
    }
    

</script>

<!--åŠ å…¥è¡Œå·çš„é«˜äº®ä»£ç å—æ ·å¼-->

<style>
    pre{
        position: relative;
        margin-bottom: 24px;
        border-radius: 10px;
        border: 1px solid #e2dede;
        background: #FFF;
        overflow: hidden;
    }
    code.has-numbering{
        margin-left: 30px;
    }
    code.has-numbering.widther{
        margin-left: 35px;
    }
    .pre-numbering{
        margin: 0px;
        position: absolute;
        top: 0;
        left: 0;
        width: 20px;
        padding: 0.5em 3px 0.7em 5px;
        border-right: 1px solid #C3CCD0;
        text-align: right;
        color: #AAA;
        background-color: #fafafa;
    }
    .pre-numbering.widther {
        width: 35px;
    }
</style>

<!--è‡ªå®šä¹‰æ ·å¼è®¾ç½®-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
        .nav .hide-list.fullscreen {
            left: 492px
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*åˆ—è¡¨æ ·å¼*/
    
    .post .pjax article .article-entry>ol, .post .pjax article .article-entry>ul, .post .pjax article>ol, .post .pjax article>ul{
        border: #e2dede solid 1px;
        border-radius: 10px;
        padding: 10px 32px 10px 56px;
    }
    .post .pjax article .article-entry li>ol, .post .pjax article .article-entry li>ul,.post .pjax article li>ol, .post .pjax article li>ul{
        padding-top: 5px;
        padding-bottom: 5px;
    }
    .post .pjax article .article-entry>ol>li, .post .pjax article .article-entry>ul>li,.post .pjax article>ol>li, .post .pjax article>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    .post .pjax article .article-entry li>ol>li, .post .pjax article .article-entry li>ul>li,.post .pjax article li>ol>li, .post .pjax article li>ul>li{
        margin-bottom: auto;
        margin-left: auto;
    }
    

    /* èƒŒæ™¯å›¾æ ·å¼ */
    
    


    /*å¼•ç”¨å—æ ·å¼*/
    

    /*æ–‡ç« åˆ—è¡¨èƒŒæ™¯å›¾*/
    
    .nav-right:before {
        content: ' ';
        display: block;
        position: absolute;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        opacity: 0.3;
        background: url("https://i.loli.net/2019/07/22/5d3521411f3f169375.png");
        background-repeat: no-repeat;
        background-position: 50% 0;
        -ms-background-size: cover;
        -o-background-size: cover;
        -moz-background-size: cover;
        -webkit-background-size: cover;
        background-size: cover;
    }
    

    
</style>







</html>
